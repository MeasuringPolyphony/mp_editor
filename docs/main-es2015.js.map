{"version":3,"sources":["./$_lazy_route_resource lazy namespace object","./src/app/app.component.ts","./src/app/app.component.html","./src/app/app.module.ts","./src/app/input/diva-view/diva-view.component.ts","./src/app/input/diva-view/diva-view.component.html","./src/app/input/input.component.ts","./src/app/input/input.component.html","./src/app/input/input.module.ts","./src/app/input/input.service.ts","./src/app/input/staff-select/staff-select.component.ts","./src/app/input/staff-select/staff-select.component.html","./src/app/input/toolbar/toolbar.component.ts","./src/app/input/toolbar/toolbar.component.html","./src/app/score-editor/doc.service.ts","./src/app/score-editor/score-diva-view/score-diva-view.component.ts","./src/app/score-editor/score-diva-view/score-diva-view.component.html","./src/app/score-editor/score-editor.component.ts","./src/app/score-editor/score-editor.component.html","./src/app/score-editor/score-editor.module.ts","./src/app/score-editor/score-toolbar/score-toolbar.component.ts","./src/app/score-editor/score-toolbar/score-toolbar.component.html","./src/app/score-editor/score-verovio-view/score-verovio-view.component.ts","./src/app/score-editor/score-verovio-view/score-verovio-view.component.html","./src/app/score-editor/selected-staff.service.ts","./src/app/select-document/select-document.component.ts","./src/app/select-document/select-document.component.html","./src/app/state-service.service.ts","./src/app/tools.ts","./src/app/utils/MusicItem.ts","./src/app/utils/definitions.ts","./src/app/utils/mei.ts","./src/app/utils/part.ts","./src/app/utils/system.ts","./src/app/utils/verovio.ts","./src/environments/environment.ts","./src/main.ts"],"names":[],"mappings":"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","file":"main-es2015.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","import { Component } from '@angular/core';\nimport { vrvToolkit } from './utils/verovio';\n\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})\nexport class AppComponent {\n  constructor() {\n    vrvToolkit.setup();\n  }\n}\n","<!-- Navigation -->\n<nav class=\"navbar navbar-expand-lg navbar-light\" id=\"mainNav\">\n    <a class=\"navbar-brand\" routerLink=\"/\">\n       <img src=\"assets/img/thumbnail.png\" id=\"thumbnail\">\n       <div id=\"navTitle\">Measuring Polyphony</div>\n       <div id=\"navDescription\">Digital encodings of late medieval music</div>\n       <div class=\"clearfix\"></div>\n    </a>\n    <div id=\"transcriptionDiv\">\n        <a href=\"./\">\n            <button color=primary class=\"primary-button\" id=\"new-transcription-button\" mat-stroked-button>\n                Start a New Transcription\n            </button>\n        </a>\n    </div>\n</nav>\n\n<router-outlet></router-outlet>\n","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\nimport { ReactiveFormsModule, FormsModule } from '@angular/forms';\nimport { RouterModule, Routes } from '@angular/router';\n\nimport { MatTabsModule } from '@angular/material/tabs';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatDividerModule } from '@angular/material/divider';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatSelectModule } from '@angular/material/select';\n\nimport { InputModule } from './input/input.module';\nimport { InputComponent } from './input/input.component';\n\nimport { AppComponent } from './app.component';\nimport { SelectDocumentComponent } from './select-document/select-document.component';\nimport { ScoreEditorModule } from './score-editor/score-editor.module';\nimport { ScoreEditorComponent } from './score-editor/score-editor.component';\n\nconst routes: Routes = [\n  {\n    path: 'input/:source/:identifier',\n    component: InputComponent\n  },\n  {\n    path: 'score/:source/:identifier',\n    component: ScoreEditorComponent\n  },\n  {\n    path: '',\n    // redirectTo: '/input/gallica/12148%2Fbtv1b8454675g',\n    component: SelectDocumentComponent,\n    pathMatch: 'full'\n  }\n]\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    SelectDocumentComponent\n  ],\n  imports: [\n    RouterModule.forRoot(\n      routes,\n      { useHash: true }\n      //{ enableTracing: true }\n    ),\n    BrowserModule,\n    FormsModule,\n    ReactiveFormsModule,\n    MatTabsModule,\n    MatButtonModule,\n    MatDividerModule,\n    MatFormFieldModule,\n    MatSelectModule,\n    InputModule,\n    ScoreEditorModule\n  ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n","/**\n * This component contains diva.js and has the staff bounding boxes\n * rendered over it. This is always visible.\n */\nimport { Component, OnInit, OnDestroy, Input, ViewEncapsulation, HostListener } from '@angular/core';\n\nimport { IRI, Voice } from '../../utils/definitions';\nimport { System, Pb, Sb } from '../../utils/system';\nimport { Part } from '../../utils/part';\nimport { StateService } from '../../state-service.service';\nimport { InputService } from '../input.service';\n\nimport Diva from 'diva.js';\n\n@Component({\n  selector: 'app-diva-view',\n  templateUrl: './diva-view.component.html',\n  styleUrls: ['./diva-view.component.css'],\n  encapsulation: ViewEncapsulation.None\n})\nexport class DivaViewComponent implements OnInit, OnDestroy {\n  diva: Diva;\n  creatingStaff: boolean = false;\n  firstPoint: DOMPoint = null;\n\n  @Input() iiifManifest: IRI;\n\n  constructor (private selectedSystem: InputService, private stateService: StateService) {}\n\n  ngOnInit() {\n    this.diva = new Diva('diva-wrapper', {\n      objectData: this.iiifManifest\n    });\n\n    Diva.Events.subscribe('ActivePageDidChange', this.refreshOverlay.bind(this), this.diva.settings.ID);\n    Diva.Events.subscribe('DocumentDidLoad', this.refreshOverlay.bind(this), this.diva.settings.ID);\n    Diva.Events.subscribe('ZoomLevelDidChange', this.handleZoom.bind(this), this.diva.settings.ID);\n\n    // this.diva.disableDragScrollable();\n\n    this.selectedSystem.subscribe(() => {\n      this.refreshOverlay(this.diva.getActivePageIndex());\n    });\n  }\n\n  ngOnDestroy() {\n    this.selectedSystem.selected = null;\n    try {\n      this.diva.deactivate();\n      this.diva.destroy();\n    }\n    catch (e) {\n      console.warn(e);\n    }\n  }\n\n  @HostListener('window:keydown.shift', [])\n  handleKeydown() {\n    this.diva.disableDragScrollable();\n  }\n\n  @HostListener('window:keyup.shift', [])\n  handleKeyup() {\n    if (!this.creatingStaff) {\n      this.diva.enableDragScrollable();\n    }\n  }\n\n  clickHandler(evt: MouseEvent) {\n    const target = evt.target as Element;\n    if (target.tagName === 'rect') {\n      // Unselect previously selected staff.\n      Array.from(document.getElementsByClassName(\"selectedZone\"))\n        .forEach(elem => {\n          elem.classList.remove(\"selectedZone\");\n        });\n\n      let staff = this.stateService.mei.getSystem(target.id);\n      if (staff !== null) {\n        this.selectedSystem.selected = staff;\n        target.classList.add(\"selectedZone\");\n      }\n    }\n  }\n\n  mousedownHandler(evt: MouseEvent) {\n    if (evt.shiftKey) {\n      this.creatingStaff = true;\n\n      const activeContainer = document.getElementById('editor-container-' + this.diva.getActivePageIndex().toString()).firstElementChild as SVGSVGElement;\n      const clientPoint = activeContainer.createSVGPoint();\n      clientPoint.x = evt.clientX;\n      clientPoint.y = evt.clientY;\n\n      const transformMatrix = activeContainer.getScreenCTM();\n      this.firstPoint = clientPoint.matrixTransform(transformMatrix.inverse());\n\n      // Create the initial drawing rect\n      let rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n      rect.setAttribute('x', this.firstPoint.x.toString());\n      rect.setAttribute('y', this.firstPoint.y.toString());\n      rect.setAttribute('width', '0');\n      rect.setAttribute('height', '0');\n      rect.classList.add(\"zoneRect\");\n      rect.id = 'drawing-rect';\n\n      activeContainer.appendChild(rect);\n    }\n  }\n\n  mousemoveHandler(evt: MouseEvent) {\n    if (this.creatingStaff) {\n      const drawingRect = document.getElementById('drawing-rect') as unknown as SVGRectElement;\n      if (drawingRect !== null) {\n        const container = drawingRect.viewportElement as SVGSVGElement;\n        const currentPoint = container.createSVGPoint();\n        currentPoint.x = evt.clientX;\n        currentPoint.y = evt.clientY;\n\n        const transformedPoint = currentPoint.matrixTransform(\n          container.getScreenCTM().inverse()\n        );\n\n        drawingRect.setAttribute('x', Math.min(transformedPoint.x, this.firstPoint.x).toString());\n        drawingRect.setAttribute('y', Math.min(transformedPoint.y, this.firstPoint.y).toString());\n\n        drawingRect.setAttribute('width', Math.abs(transformedPoint.x - this.firstPoint.x).toString());\n        drawingRect.setAttribute('height', Math.abs(transformedPoint.y - this.firstPoint.y).toString());\n      }\n    }\n  }\n\n  mouseupHandler(evt: MouseEvent) {\n    if (this.creatingStaff) {\n      this.diva.enableDragScrollable();\n      this.creatingStaff = false;\n\n      const pageIndex = this.diva.getActivePageIndex();\n\n      const activeContainer = document.getElementById('editor-container-' + pageIndex.toString()).firstElementChild as SVGSVGElement;\n      const clientPoint = activeContainer.createSVGPoint();\n      clientPoint.x = evt.clientX;\n      clientPoint.y = evt.clientY;\n\n      const transformMatrix = activeContainer.getScreenCTM();\n      const secondPoint = clientPoint.matrixTransform(transformMatrix.inverse());\n\n      // Get Pb element if one exists\n      let pb = this.stateService.mei.getPb(pageIndex);\n      if (pb === null) {\n        // Make new Pb\n        pb = new Pb(this.diva.getCurrentCanvas());\n        pb.index = pageIndex;\n      }\n\n      // Create sb\n      let sb = new Sb(\n        {\n          ulx: Math.min(this.firstPoint.x, secondPoint.x),\n          uly: Math.min(this.firstPoint.y, secondPoint.y),\n          lrx: Math.max(secondPoint.x, this.firstPoint.x),\n          lry: Math.max(secondPoint.y, this.firstPoint.y),\n        }\n      );\n\n      // Determine Part\n      let part: Part;\n      if (this.selectedSystem.selected !== null) {\n        part = this.selectedSystem.selected.parent;\n      } else {\n        part = this.stateService.mei.getOrCreatePart(Voice.triplum);\n      }\n\n      const newSystem = new System();\n      newSystem.pb = pb;\n      newSystem.sb = sb;\n      part.addSystem(newSystem);\n\n      // Mark as selected\n      this.selectedSystem.selected = newSystem;\n\n      // Clean up\n      this.refreshOverlay(pageIndex);\n      this.firstPoint = null;\n    }\n  }\n\n  refreshOverlay(pageIndex: number): void {\n    // Get some features from the diva viewer\n    const inner = this.diva.settings.innerElement;\n    const dimensions = this.diva.getPageDimensionsAtCurrentZoomLevel(pageIndex);\n    const offset = this.diva.settings.viewHandler._viewerCore.getPageRegion(\n      pageIndex,\n      {\n        includePadding: true,\n        incorporateViewport: true\n      }\n    );\n    const marginLeft = getComputedStyle(inner, null).getPropertyValue('margin-left');\n\n    // Check if we have a div for this page. Otherwise create one.\n    let pageContainer = document.getElementById('editor-container-' + pageIndex.toString());\n    if (pageContainer === null) {\n      //pageContainer = document.createElement('div');\n      pageContainer = document.createElement('div');\n      pageContainer.id = 'editor-container-' + pageIndex.toString();\n      pageContainer.classList.add('editor-container'); // For future use\n      inner.appendChild(pageContainer); // Add the container to the DOM\n    }\n\n    // Create SVG container\n    const svgParent = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n    const maxZoom = this.diva.getPageDimensionsAtZoomLevel(pageIndex, Number.MAX_SAFE_INTEGER)\n    svgParent.setAttribute('width', dimensions.width.toString());\n    svgParent.setAttribute('height', dimensions.height.toString());\n    svgParent.setAttribute('viewBox', '0 0 ' + maxZoom.width + ' ' + maxZoom.height);\n\n    pageContainer.style.position = 'absolute';\n    pageContainer.style.top = `${offset.top}px`;\n    pageContainer.style.left = `${offset.left - parseInt(marginLeft)}px`;\n\n    while (pageContainer.firstChild !== null) {\n      pageContainer.firstChild.remove();\n    }\n\n    let systemsOnPage = this.stateService.mei.getSystems().filter(system => {\n      return system.pb.index === pageIndex;\n    });\n\n    for (const staff of systemsOnPage) {\n      let item = staff.sb.svg;\n      svgParent.appendChild(item);\n      if (this.selectedSystem.selected === staff) {\n        item.classList.add(\"selectedZone\");\n      }\n    }\n\n    pageContainer.appendChild(svgParent);\n  }\n\n  handleZoom(): void {\n    (new Promise(resolve => {\n      Array.from(document.getElementsByClassName('editor-container'))\n        .forEach((elem: HTMLElement) => { elem.style.display = 'none'; });\n      setTimeout(resolve, this.diva.settings.zoomDuration + 100);\n    })).then(() => {\n      this.refreshOverlay(this.diva.getActivePageIndex());\n      Array.from(document.getElementsByClassName('editor-container'))\n        .forEach((elem: HTMLElement) => {\n          elem.style.display = '';\n        });\n    });\n  }\n}\n","<div id=\"diva-wrapper\"\n    (mousedown)=\"mousedownHandler($event)\"\n    (mousemove)=\"mousemoveHandler($event)\"\n    (click)=\"clickHandler($event)\"\n    (mouseup)=\"mouseupHandler($event)\">\n</div>\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\n\nimport { IRI } from '../utils/definitions';\nimport { MEIDocument } from '../utils/mei';\nimport { formIIIFManifest } from '../tools';\nimport { StateService } from '../state-service.service';\n\n@Component({\n  selector: 'app-input',\n  templateUrl: './input.component.html',\n  styleUrls: ['./input.component.css']\n})\nexport class InputComponent implements OnInit {\n  iiifManifest: IRI;\n\n  // Metadata for MEI header\n  shortTitle = \"\";\n  composerName = \"\";\n  userName = \"\";\n  notationSubtype = \"\";\n\n  inputStep: InputComponent.InputStep;\n\n  source: string;\n  identifier: string;\n\n  constructor(\n    private stateService: StateService,\n    private route: ActivatedRoute,\n  ) {\n    this.inputStep = InputComponent.InputStep.METADATA;\n    this.source = this.route.snapshot.paramMap.get('source');\n    this.identifier = decodeURIComponent(this.route.snapshot.paramMap.get('identifier'));\n    this.iiifManifest = formIIIFManifest(this.source, this.identifier);\n\n    if (!this.stateService.mei) {\n      this.stateService.mei = new MEIDocument(this.iiifManifest);\n    }\n\n    if (this.stateService.mei.metadata != undefined) {\n      this.shortTitle = this.stateService.mei.metadata.shortTitle;\n      this.composerName = this.stateService.mei.metadata.composerName;\n      this.userName = this.stateService.mei.metadata.encoderName;\n      this.notationSubtype = this.stateService.mei.notationSubtype;\n    }\n\n    console.debug(this.iiifManifest);\n  }\n\n  ngOnInit() {\n    this.stateService.editorialMode = false;\n  }\n\n  onSetMetadata() {\n    this.stateService.mei.metadata = {\n      shortTitle: this.shortTitle,\n      composerName: this.composerName,\n      encoderName: this.userName,\n      sourceIRI: this.iiifManifest,\n    };\n    this.stateService.mei.notationSubtype = this.notationSubtype;\n    this.inputStep = InputComponent.InputStep.INPUT;\n  }\n}\n\nexport namespace InputComponent {\n  export enum InputStep {\n    METADATA,\n    INPUT\n  }\n}\n","<div id=\"editor-container\">\n    <app-diva-view [iiifManifest]=\"iiifManifest\"></app-diva-view>\n    <div id=\"right-side\">\n        <mat-tab-group>\n            <mat-tab label=\"Metadata Input\" *ngIf=\"inputStep === 0\">\n                <form *ngIf=\"inputStep===0\" #metadataForm=\"ngForm\" (submit)=\"onSetMetadata()\">\n                    <h1 id=\"metadata-header\">Enter Metadata</h1>\n                    <label class=\"metadataInput\">Short title:&nbsp;\n                        <input [(ngModel)]=\"shortTitle\" id=\"shortTitle\" name=\"shortTitle\"/>\n                    </label><br>\n                    <label class=\"metadataInput\">Composer name:&nbsp;\n                        <input [(ngModel)]=\"composerName\" id=\"composerName\" name=\"composerName\"/>\n                    </label><br>\n                    <label class=\"metadataInput\">Your name:&nbsp;\n                        <input [(ngModel)]=\"userName\" id=\"userName\" name=\"userName\"/>\n                    </label><br>\n                    <label class=\"metadataInput\">Notation:&nbsp;\n                        <select [(ngModel)]=\"notationSubtype\" id=\"notationSubtype\" name=\"notationSubtype\">\n                            <option value=\"Ars_antiqua\">Black Mensural &mdash; Ars antiqua</option>\n                            <option value=\"Ars_nova\">Black Mensural &mdash; Ars nova</option>\n                            <option value=\"\">White Mensural</option>\n                        </select>\n                    </label><br>\n                    <button color=primary class=\"primary-button\" mat-stroked-button type=\"submit\">Continue to Music Input</button>\n                </form>\n            </mat-tab>\n            <mat-tab label=\"Music Input\" *ngIf=\"inputStep === 1\">\n                <mat-divider></mat-divider>\n                <app-toolbar *ngIf=\"inputStep===1\"></app-toolbar>\n                <mat-divider></mat-divider>\n                <app-staff-select *ngIf=\"inputStep===1\"></app-staff-select>\n            </mat-tab>\n            <mat-tab label=\"General Help\">\n                <h2>Manuscript Navigation</h2>\n                <ul>\n                    <li>\n                        To select the page of the manuscript you want to work on,\n                        either use the scrollbar to the right of the manuscript\n                        or type the folio number in the box and click the <code>Go</code>\n                        button.\n                    </li>\n                    <li>\n                        Click the magnifying boxes for the appropriate zoom level\n                        and move around the manuscript using your mouse or the\n                        trackpad.\n                    </li>\n                </ul>\n                <mat-divider></mat-divider>\n                <h2>Metadata Entry</h2>\n                <p>\n                    First enter basic metadata about the document.\n                    This includes the name of the work, composer name,\n                    and your name. If there is something you don't know,\n                    you can leave it as is and continue.\n                    <br>\n                    Metadata must be entered before staff input can fully begin.\n                </p>\n                <mat-divider></mat-divider>\n                <h2>Staff Entry</h2>\n                <ul>\n                    <li>\n                        To select an area for a new staff, hold <code>Shift</code>\n                        and click-and-drag an area for the staff on the Diva.js\n                        viewer. When you release the mouse, a staff is added.\n                    </li>\n                    <li>\n                        To select a staff, click on the bounding box on the viewer.\n                    </li>\n                    <li>\n                        When a staff is selected, the voice it belongs to and\n                        mensuration of that voice can be set on the right.\n                        This information is saved automatically.\n                    </li>\n                    <li>\n                        To add musical components, begin typing. This will add\n                        musical elements to the staff below the voice and mensuration\n                        options. Information on this is available under the \"Music\n                        Input Help\" Tab.\n                    </li>\n                    <li>\n                        To delete a staff, first select it and then click the\n                        \"Delete Staff\" button under the \"Staff Input\" tab.\n                    </li>\n                </ul>\n                <mat-divider></mat-divider>\n                <h2>Saving Work for Later</h2>\n                <p>\n                    Work can be saved for later using the <em>Save/Load My Work</em>\n                    button. Current information in the input editor can be saved to\n                    one of the available workspaces. That workspace can be loaded later\n                    if the same browser is used and the browser storage hasn't been cleared.\n                </p>\n            </mat-tab>\n            <mat-tab label=\"Music Input Help\">\n                <h2>Music Input Instructions</h2>\n                <ul>\n                    <li> <b> Adding clef</b>\n                    \t<ul>\n                    \t<li> Type <span class=\"hi\">C</span> to insert C3 clef,\n                            or <span class=\"hi\">F</span> to insert F4 clef.</li>\n                        <li> Press the up or down arrows to move the clef to another line.</li>\n                    \t</ul>\n                    </li>\n\n                    <li> <b> Adding key signatures</b>\n                        <ul>\n                        <li> Type <span class=\"hi\">k</span> to enter key signature mode after adding a clef.</li>\n                        <li> Then enter the pitch name letter and accidental to add to key signature.</li>\n                        <li> To remove from a key signature, enter the same pitch letter and accidental again.</li>\n                        <li> Example: For F-sharp, type <span class=\"hi\">k f #</span></li>\n                        </ul>\n                    </li>\n\n                    <li> <b> Adding pitches</b>\n                    \t<ul>\n                    \t<li> Type pitch <span class=\"hi\">letter</span> name of each note to add them to the line: <span class=\"hi\">f.ed.efgagfgedderfag</span></li>\n                    \t<li> Type \"<span class=\"hi\">.</span>\" to add dot after note.</li>\n                    \t<li> Type \"<span class=\"hi\">r</span>\" to add a rest.</li>\n                    \t<li> Type <span class=\"hi2\">backspace</span> to delete note.</li>\n                    \t<li> Capital letters choose direction of pitch class which is greater then lower case letters.</li>\n                    \t<li> <span class=\"hi2\">Up/down</span> arrows transpose last pitch up/down a step.</li>\n                    \t<li> <span class=\"hi2\">shift-Up/down</span> arrows transpose last pitch up/down an octave.</li>\n                    \t</ul>\n                    </li>\n\n                    <li><b> Adding Accidentals</b><br>\n                        After adding a note:\n                        <ul>\n                            <li> press <code>-</code> to add a flat.</li>\n                            <li> press <code>#</code> to add a sharp.</li>\n                            <li> press <code>n</code> to add a natural.</li>\n                            <li> press <code>N</code> to clear accidentals.</li>\n                        </ul>\n                    </li>`\n\n                    <li><b> Adding ligatures</b>\n                        <ul>\n                            <li> After adding a note, press <span class=\"hi2\">[</span> to start a ligature.</li>\n                            <li> After adding a note, press <span class=\"hi2\">]</span> to end a ligature.</li>\n                        </ul>\n                    </li>\n\n                    <li> <b> Adding rhythm</b>\n                    \t<ul>\n                    \t\t<li> <span class=\"hi\">1</span> semibreve,\n                    \t\t     <span class=\"hi\">2</span> minim,\n                    \t\t     <span class=\"hi\">4</span> semiminim,\n                    \t\t     <span class=\"hi\">8</span> fusa,\n                    \t\t     <span class=\"hi\">6</span> semifusa,\n                    \t\t     <span class=\"hi\">0</span> breve,\n                    \t\t     <span class=\"hi\">9</span> long,\n                    \t\t     <span class=\"hi\">7</span> maxima. </li>\n                    \t\t<li> <i>Interleaved method</i>: type (new) rhythm before adding a note.  The default rhythm is whole note (semibreve).  First note's rhythm should be typed before adding clef.</li>\n                    \t\t<li> <i>Second-pass method</i>: type pitches first, then select first note and type rhythms to update note rhythms.</li>\n                    \t\t<li> <i>Selective second-pass method</i>: type most common rhythm, then clef, then notes, then click on notes that need rhythms to fix.  Typing rhythm number will change rhythm and advance to next note.</li>\n                    \t\t<li> left/right arrow keys or tab/shift-tab moves to next/previous note/rest/clef.</li>\n                    \t</ul>\n                    </li>\n\n                    <li> <b> Adding text</b>\n                    \t<ul>\n                    \t\t<li>Click on a note (or left/right arrows or tab/shift-tab to move to target note).</li>\n                    \t\t<li>Type text for note, then press tab or right arrow key or click to go to next note.</li>\n                            <li> <span class=\"hi2\">backspace</span> delete last letter.</li>\n                            <li> <span class=\"hi2\">shift-backspace</span> deletes entire syllable.</li>\n                            <li> Add dash at end of text for note to continue word to next note.</li>\n                            <li> To correct mistyped text, click the note to highlight it and press backspace. Then type the new text that belongs to that note.</li>\n                    \t</ul>\n                    </li>\n\n                    <li> <b> Repeating tenor</b>\n                        <ul>\n                            <li>When a staff that belongs to the tenor part is selected, the number of statements can be indicated.</li>\n                            <li>If more than one tenor statement is indicated, a repeating tenor will be generated.</li>\n                            <li>Where the tenor repeats from can be set after entering that element by pressing the \"Set End of Repeating Tenor\" button.\n                                The ending will be highlighted in blue.\n                            </li>\n                            <li>If no end point is specified, the entire tenor will repeat by default.</li>\n                        </ul>\n                    </li>\n                </ul>\n            </mat-tab>\n        </mat-tab-group>\n    </div>\n</div>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { MatTabsModule } from '@angular/material/tabs';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatDividerModule } from '@angular/material/divider';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatSelectModule } from '@angular/material/select';\n\nimport { DivaViewComponent } from './diva-view/diva-view.component';\nimport { StaffSelectComponent } from './staff-select/staff-select.component';\nimport { ToolbarComponent } from './toolbar/toolbar.component';\nimport { InputComponent } from './input.component';\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\n\n@NgModule({\n  declarations: [\n    DivaViewComponent,\n    StaffSelectComponent,\n    StaffSelectComponent,\n    ToolbarComponent,\n    InputComponent,\n  ],\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    BrowserAnimationsModule,\n    MatTabsModule,\n    MatButtonModule,\n    MatDividerModule,\n    MatDialogModule,\n    MatFormFieldModule,\n    MatSelectModule\n  ],\n  exports: [\n    InputComponent\n  ]\n})\nexport class InputModule { }\n","import { Injectable } from '@angular/core';\nimport { Subject } from 'rxjs'\n\nimport { System } from '../utils/system';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class InputService extends Subject<System> {\n\n  _selected: System;\n\n  constructor() {\n    super();\n    this._selected = null;\n  }\n\n  get selected(): System {\n    return this._selected;\n  }\n\n  set selected(system: System) {\n    this._selected = system;\n    this.next(this._selected);\n  }\n}\n","import { Component, OnInit, HostListener, ViewChild, ElementRef } from '@angular/core';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { PitchClass, NoteItem, RestItem, Accid, LigStatus, PlicaStatus } from '../../utils/MusicItem';\nimport { StateService } from '../../state-service.service';\nimport { InputService } from '../input.service';\nimport { vrvToolkit } from '../../utils/verovio';\nimport { Tenor } from '../../utils/part';\nimport { Voice } from '../../utils/definitions';\n\n@Component({\n  selector: 'app-staff-select',\n  templateUrl: './staff-select.component.html',\n  styleUrls: ['./staff-select.component.css']\n})\nexport class StaffSelectComponent implements OnInit {\n  @ViewChild('example') container: ElementRef;\n  voices = Object.entries(Voice);\n  keySigMode = false;\n  pitchSig: string = null;\n  accidSig: string = null;\n  selected = null;\n  constructor(\n    private selectedSystem: InputService,\n    private stateService: StateService,\n    private route: ActivatedRoute,\n    private router: Router\n  ) { }\n\n  ngOnInit() {\n    this.selectedSystem.subscribe({\n      next: (staff) => {\n        this.selected = staff;\n        this.container.nativeElement.innerHTML = '';\n        if (staff === null) return;\n        let element = vrvToolkit.humdrumToSVG(staff.contents.getHumdrumScore());\n        this.container.nativeElement.appendChild(element);\n      }\n    });\n  }\n\n  updateSVG() {\n    let white = this.selectedSystem.selected.parent.parent.notationType === \"mensural.white\";\n    let element = vrvToolkit.humdrumToSVG(this.selectedSystem.selected.contents.getHumdrumScore({white: white}));\n    this.container.nativeElement.innerHTML = '';\n    this.container.nativeElement.appendChild(element);\n\n    if (/^[tT]enor/.test(this.selectedSystem.selected.parent.voice)) {\n      const tenor = this.selectedSystem.selected.parent as Tenor;\n      if (tenor.endingId !== undefined) {\n        let endNote = element.getElementById(tenor.endingId);\n        if (endNote !== null) {\n          endNote.setAttribute('fill', '#00f');\n        }\n      }\n    }\n  }\n\n  staffForm = new FormGroup({\n    voice: new FormControl(''),\n    modus: new FormControl(''),\n    tempus: new FormControl(''),\n    prolatio: new FormControl(''),\n  });\n\n  mensurForm = new FormGroup({\n    modus2: new FormControl(''),\n    tempus2: new FormControl(''),\n    prolatio2: new FormControl(''),\n  });\n\n  handleClick(event: MouseEvent) {\n    let target = event.target as Element;\n    while (target) {\n      if (target.nodeName === 'g') {\n        let matches: Array<string>;\n        if (matches = target.id.match(/-.*L(\\d+)/)) {\n          this.selectedSystem.selected.contents.selectItemByLine(parseInt(matches[1]))\n          this.updateSVG();\n          break;\n        }\n      }\n      target = target.parentNode as Element;\n    }\n  }\n\n  finishStep() {\n    // const mei = this.meiService.generateFullMEI();\n    const type = this.route.snapshot.paramMap.get('source');\n    const identifier = this.route.snapshot.paramMap.get('identifier');\n    // this.stateService.mei = mei;\n    this.router.navigate(['/score', type, identifier]);\n  }\n\n  repTenorButton() {\n    const tenor = this.stateService.mei.getPart(Voice.tenor) as Tenor;\n    try {\n        let layer = this.container.nativeElement.querySelector('.layer');\n        tenor.endingId = layer.lastElementChild.id;\n    } catch (e) {\n      console.debug(e);\n      tenor.endingId = undefined;\n    }\n    this.updateSVG();\n  }\n\n  @HostListener('document:keydown', ['$event'])\n  handleKeyPress(event: KeyboardEvent) {\n    if (this.selectedSystem.selected == null) return;\n\n    if (this.keySigMode) {\n      this.handleKeySigPress(event);\n      event.preventDefault();\n      this.updateSVG();\n      return;\n    }\n\n    // Based on processKeypress function in mensural-input\n    if (event.metaKey) return;\n    let musicList = this.selectedSystem.selected.contents;\n    if ((musicList.m_index >=0) && (event.key.length === 1)) {\n      if ((event.key >= '0') && (event.key <= '9')) {\n        this.processDigit(Number(event.key), event);\n        event.preventDefault();\n        this.updateSVG();\n        return;\n      }\n      if (event.key !== ' ') {\n        let state = musicList.addTextToCurrentItem(event.key);\n        if (state) {\n          event.preventDefault();\n          this.updateSVG();\n          return;\n        }\n      }\n    }\n    if ((musicList.m_index >= 0) && (event.key === 'Backspace')) {\n      if (event.shiftKey) {\n        musicList.clearTextOnCurrentItem();\n      }\n      else {\n        musicList.deleteCharacterOnCurrentItem();\n      }\n      event.preventDefault();\n    }\n    else if ((musicList.m_index < 0) && (event.key === 'Backspace')) {\n      musicList.removeLastItem();\n      event.preventDefault();\n    }\n    else {\n      switch (event.key) {\n        case 'k':\n          this.keySigMode = true;\n          console.debug(\"Set keySigMode\");\n          event.preventDefault();\n          break;\n        case 'C':\n          musicList.addPitchFar(PitchClass.C);\n          event.preventDefault();\n          break;\n        case 'c':\n          musicList.addPitchNear(PitchClass.C);\n          event.preventDefault();\n          break;\n        case 'D':\n          musicList.addPitchFar(PitchClass.D);\n          event.preventDefault();\n          break;\n        case 'd':\n          musicList.addPitchNear(PitchClass.D);\n          event.preventDefault();\n          break;\n        case 'E':\n          musicList.addPitchFar(PitchClass.E);\n          event.preventDefault();\n          break;\n        case 'e':\n          musicList.addPitchNear(PitchClass.E);\n          event.preventDefault();\n          break;\n        case 'F':\n          musicList.addPitchFar(PitchClass.F);\n          event.preventDefault();\n          break;\n        case 'f':\n          musicList.addPitchNear(PitchClass.F);\n          event.preventDefault();\n          break;\n        case 'G':\n          musicList.addPitchFar(PitchClass.G);\n          event.preventDefault();\n          break;\n        case 'g':\n          musicList.addPitchNear(PitchClass.G);\n          event.preventDefault();\n          break;\n        case 'A':\n          musicList.addPitchFar(PitchClass.A);\n          event.preventDefault();\n          break;\n        case 'a':\n          musicList.addPitchNear(PitchClass.A);\n          event.preventDefault();\n          break;\n        case 'B':\n          musicList.addPitchFar(PitchClass.B);\n          event.preventDefault();\n          break;\n        case 'b':\n          musicList.addPitchNear(PitchClass.B);\n          event.preventDefault();\n          break;\n        case 'm':\n        case 'M':\n          if (!musicList.hasOpenLigature()) {\n            musicList.addMensur();\n          }\n          event.preventDefault();\n          break;\n        case 'p':\n        case 'P':\n          this.processPlica(event.key);\n          event.preventDefault();\n          break;\n        case 'r':\n        case 'R':\n          if (!musicList.hasOpenLigature()) {\n            musicList.addRest();\n          } else {\n            alert(\"Can't enter a rest in an open ligature! Please close first.\")\n          }\n          event.preventDefault();\n          break;\n        case '.':\n          this.processDotKey();\n          event.preventDefault();\n          break;\n        case '0':\n        case '1':\n        case '2':\n        case '3':\n        case '4':\n        case '5':\n        case '6':\n        case '7':\n        case '8':\n        case '9':\n          this.processDigit(Number(event.key), event);\n          event.preventDefault();\n          break;\n        case 'Tab':\n          if (event.shiftKey) {\n            musicList.selectBackward();\n          } else {\n            musicList.selectForward();\n          }\n          event.preventDefault();\n          break;\n        case ' ':\n        case 'ArrowRight':\n          musicList.selectForward();\n          event.preventDefault();\n          break;\n        case 'ArrowLeft':\n          musicList.selectBackward();\n          event.preventDefault();\n          break;\n        case 'ArrowUp':\n          musicList.raisePitch(event.shiftKey ? 7 : 1);\n          event.preventDefault();\n          break;\n        case 'ArrowDown':\n          musicList.lowerPitch(event.shiftKey ? 7 : 1);\n          event.preventDefault();\n          break;\n        case 'End':\n          musicList.goToEndOfList();\n          event.preventDefault();\n          break;\n        case '[':\n          if (!musicList.hasOpenLigature()) {\n            this.processLig(true);\n          } else {\n            alert(\"A ligature is already open!\");\n          }\n          event.preventDefault();\n          break;\n        case ']':\n          if (musicList.hasOpenLigature()) {\n            this.processLig(false);\n          } else {\n            alert(\"No open ligature to close!\");\n          }\n          event.preventDefault();\n          break;\n        case '#':\n        case '-':\n        case 'N':\n        case 'n':\n          this.processAccidental(event.key);\n          event.preventDefault();\n          break;\n        }\n    }\n    this.updateSVG();\n  }\n\n  processDigit(digit: number, _event: KeyboardEvent) {\n    let musicList = this.selectedSystem.selected.contents;\n    if (musicList.m_list.length === 0) {\n      if (digit !== 3) {\n        musicList.m_rhythm = digit;\n      }\n      return;\n    }\n    var index = musicList.m_index;\n    var ending = false;\n    if (index < 0) {\n      index = musicList.m_list.length - 1;\n      ending = true;\n    }\n    let item = musicList.m_list[index];\n    if (item.m_type === 'clef') {\n      if (digit !== 3) {\n        musicList.m_rhythm = digit;\n      }\n      musicList.runNotationCallback();\n      return;\n    }\n    else if (ending) {\n      musicList.m_rhythm = digit;\n    }\n    else if ((item.m_type === 'note') || (item.m_type === 'rest')) {\n      if (!ending) {\n        if (digit !== 3) {\n          if (item.m_type === \"note\") {\n            (item as NoteItem).m_rhythm = digit;\n          }\n          else {\n            (item as RestItem).m_rhythm = digit;\n          }\n          musicList.m_index += 1;\n          musicList.m_rhythm = digit;\n          musicList.runNotationCallback();\n        }\n        if (musicList.m_index >= musicList.m_list.length) {\n          musicList.m_index = -1;\n        }\n      }\n    }\n  }\n\n  processDotKey() {\n    let musicList = this.selectedSystem.selected.contents;\n    if (musicList.m_list.length === 0) {\n      return;\n    }\n    let index = musicList.m_index;\n    if (index < 0) {\n      index = musicList.m_list.length - 1;\n    }\n    let item = musicList.m_list[index];\n    if (item.m_type === 'note') {\n      let note = item as NoteItem;\n      note.m_dot = !note.m_dot;\n      musicList.runNotationCallback();\n      return;\n    }\n  }\n\n  processLig(isStart: boolean) {\n    let musicList = this.selectedSystem.selected.contents;\n    if (musicList.m_list.length === 0) {\n      return;\n    }\n    let index = musicList.m_index;\n    if (index < 0) {\n      index = musicList.m_list.length - 1;\n    }\n    let item = musicList.m_list[index];\n    if (item.m_type === 'note') {\n      let note = item as NoteItem;\n      if (isStart) {\n        note.m_lig = note.m_lig === LigStatus.START ? LigStatus.NONE : LigStatus.START;\n      } else {\n        note.m_lig = note.m_lig === LigStatus.END ? LigStatus.NONE : LigStatus.END;\n      }\n      musicList.runNotationCallback();\n      return;\n    }\n  }\n\n  processPlica(key: string) {\n    let musicList = this.selectedSystem.selected.contents;\n    if (musicList.m_list.length === 0) {\n      return;\n    }\n    let index = musicList.m_index;\n    if (index < 0) {\n      index = musicList.m_list.length - 1;\n    }\n    let item = musicList.m_list[index];\n    if (item.m_type === 'note') {\n      let note = item as NoteItem;\n      if (key === 'p') {\n        note.m_plica = note.m_plica === PlicaStatus.DOWN ? PlicaStatus.NONE : PlicaStatus.DOWN;\n      }\n      else {\n        note.m_plica = note.m_plica === PlicaStatus.UP ? PlicaStatus.NONE : PlicaStatus.UP;\n      }\n      musicList.runNotationCallback();\n      return;\n    }\n  }\n\n  handleKeySigPress(event: KeyboardEvent) {\n    switch (event.key) {\n      case 'a':\n      case 'A':\n      case 'b':\n      case 'B':\n      case 'c':\n      case 'C':\n      case 'd':\n      case 'D':\n      case 'e':\n      case 'E':\n      case 'f':\n      case 'F':\n      case 'g':\n      case 'G':\n        if (this.pitchSig === null) {\n          this.pitchSig = event.key;\n        }\n        else {\n          this.pitchSig = null;\n          this.accidSig = null;\n          this.keySigMode = false;\n          console.debug(\"unset keySigMode\");\n        }\n        break;\n      case '#':\n      case '-':\n      case 'n':\n        if (this.pitchSig !== null && this.accidSig === null) {\n          this.accidSig = event.key;\n          let musicList = this.selectedSystem.selected.contents;\n          musicList.processKeySig(this.pitchSig, this.accidSig);\n          console.debug(\"Process with \" + this.pitchSig + \" and \" + this.accidSig);\n        }\n        this.pitchSig = null;\n        this.accidSig = null;\n        this.keySigMode = false;\n        console.debug(\"unset keySigMode\");\n        break;\n    }\n  }\n\n  processAccidental(accid: string) {\n    let musicList = this.selectedSystem.selected.contents;\n    if (musicList.m_list.length === 0) {\n      return;\n    }\n    let index = musicList.m_index;\n    if (index < 0) {\n      index = musicList.m_list.length - 1;\n    }\n    let item = musicList.m_list[index];\n    if (item.m_type === 'note') {\n      let note = item as NoteItem;\n      switch(accid) {\n        case 'N':\n          note.m_accid = Accid.NONE;\n          break;\n        case '#':\n          note.m_accid = Accid.SHARP;\n          break;\n        case '-':\n          note.m_accid = Accid.FLAT;\n          break;\n        case 'n':\n          note.m_accid = Accid.NATURAL;\n          break;\n      }\n      musicList.runNotationCallback();\n    }\n  }\n}\n","<form [formGroup]=\"staffForm\" *ngIf=\"selected\">\n    <h1>Enter Music</h1>\n    <fieldset>\n        <label class=\"music-subentry\">Voice:&nbsp;\n            <select [(ngModel)]=\"selected.voice\" formControlName=\"voice\">\n                <option *ngFor=\"let voice of voices\" value=\"{{voice[0]}}\">{{voice[1]}}</option>\n            </select>\n        </label>\n    </fieldset>\n    <h3 class=\"music-subentry\">Select Initial Mensuration:</h3>\n    <div class=\"flex-container\">\n        <fieldset>\n            <legend class=\"mensuration\">modus</legend>\n            <input [(ngModel)]=\"selected.parent.modus\" type=\"radio\" id=\"modus-3\" formControlName=\"modus\" value=\"3\"/>\n            <label for=\"modus-3\">3</label>\n            &nbsp;\n            <input [(ngModel)]=\"selected.parent.modus\" type=\"radio\" id=\"modus-2\" formControlName=\"modus\" value=\"2\"/>\n            <label for=\"modus-2\">2</label>\n            &nbsp;\n            <input [(ngModel)]=\"selected.parent.modus\" type=\"radio\" id=\"modus-na\" formControlName=\"modus\" value=\"N/A\"/>\n            <label for=\"modus-na\">N/A</label>\n        </fieldset>\n        <fieldset>\n            <legend class=\"mensuration\">tempus</legend>\n            <input [(ngModel)]=\"selected.parent.tempus\" type=\"radio\" id=\"tempus-3\" formControlName=\"tempus\" value=\"3\"/>\n            <label for=\"tempus-3\">3</label>\n            &nbsp;\n            <input [(ngModel)]=\"selected.parent.tempus\" type=\"radio\" id=\"tempus-2\" formControlName=\"tempus\" value=\"2\"/>\n            <label for=\"tempus-2\">2</label>\n            &nbsp;\n            <input [(ngModel)]=\"selected.parent.tempus\" type=\"radio\" id=\"tempus-na\" formControlName=\"tempus\" value=\"N/A\"/>\n            <label for=\"tempus-na\">N/A</label>\n        </fieldset>\n        <fieldset>\n            <legend class=\"mensuration\">prolatio</legend>\n            <input [(ngModel)]=\"selected.parent.prolatio\" type=\"radio\" id=\"prolatio-3\" formControlName=\"prolatio\" value=\"3\"/>\n            <label for=\"prolatio-3\">3</label>\n            &nbsp;\n            <input [(ngModel)]=\"selected.parent.prolatio\" type=\"radio\" id=\"prolatio-2\" formControlName=\"prolatio\" value=\"2\"/>\n            <label for=\"prolatio-2\">2</label>\n            &nbsp;\n            <input [(ngModel)]=\"selected.parent.prolatio\" type=\"radio\" id=\"prolatio-na\" formControlName=\"prolatio\" value=\"N/A\"/>\n            <label for=\"prolatio-na\">N/A</label>\n        </fieldset>\n    </div>\n</form>\n<div #example (click)=\"handleClick($event)\"></div>\n<div id=\"mensur-change\" *ngIf=\"selected && selected.contents.m_index >= 0 && selected.contents.m_list[selected.contents.m_index].m_type == 'mensur'\">\n    <form [formGroup]=\"mensurForm\">\n    <fieldset>\n        <legend class=\"mensuration\">modus</legend>\n        <input [(ngModel)]=\"selected.contents.m_list[selected.contents.m_index].m_modus\" type=\"radio\" id=\"modus2-3\" formControlName=\"modus2\" value=\"3\"/>\n        <label for=\"modus2-3\">3</label>\n        &nbsp;\n        <input [(ngModel)]=\"selected.contents.m_list[selected.contents.m_index].m_modus\" type=\"radio\" id=\"modus2-2\" formControlName=\"modus2\" value=\"2\"/>\n        <label for=\"modus2-2\">2</label>\n        &nbsp;\n        <input [(ngModel)]=\"selected.contents.m_list[selected.contents.m_index].m_modus\" type=\"radio\" id=\"modus2-na\" formControlName=\"modus2\" value=\"N/A\"/>\n        <label for=\"modus2-na\">N/A</label>\n    </fieldset>\n    <fieldset>\n        <legend class=\"mensuration\">tempus</legend>\n        <input [(ngModel)]=\"selected.contents.m_list[selected.contents.m_index].m_tempus\" type=\"radio\" id=\"tempus2-3\" formControlName=\"tempus2\" value=\"3\"/>\n        <label for=\"tempus2-3\">3</label>\n        &nbsp;\n        <input [(ngModel)]=\"selected.contents.m_list[selected.contents.m_index].m_tempus\" type=\"radio\" id=\"tempus2-2\" formControlName=\"tempus2\" value=\"2\"/>\n        <label for=\"tempus2-2\">2</label>\n        &nbsp;\n        <input [(ngModel)]=\"selected.contents.m_list[selected.contents.m_index].m_tempus\" type=\"radio\" id=\"tempus2-na\" formControlName=\"tempus2\" value=\"N/A\"/>\n        <label for=\"tempus2-na\">N/A</label>\n    </fieldset>\n    <fieldset>\n        <legend class=\"mensuration\">prolatio</legend>\n        <input [(ngModel)]=\"selected.contents.m_list[selected.contents.m_index].m_prolatio\" type=\"radio\" id=\"prolatio2-3\" formControlName=\"prolatio2\" value=\"3\"/>\n        <label for=\"prolatio2-3\">3</label>\n        &nbsp;\n        <input [(ngModel)]=\"selected.contents.m_list[selected.contents.m_index].m_prolatio\" type=\"radio\" id=\"prolatio2-2\" formControlName=\"prolatio2\" value=\"2\"/>\n        <label for=\"prolatio2-2\">2</label>\n        &nbsp;\n        <input [(ngModel)]=\"selected.contents.m_list[selected.contents.m_index].m_prolatio\" type=\"radio\" id=\"prolatio2-na\" formControlName=\"prolatio2\" value=\"N/A\"/>\n        <label for=\"prolatio2-na\">N/A</label>\n    </fieldset>\n    </form>\n</div>\n<div id=\"tenor-section\" *ngIf=\"selected && selected.voice === 'tenor'\">\n    <p>\n        If the piece has repetitions of the tenor that are not written out in full,\n        please specify here. See \"Music Input Help\" for details.\n    </p>\n    <button class=\"primary-button\" mat-stroked-button (click)=\"repTenorButton()\">Set End of Repeating Tenor</button>\n    &nbsp;\n    <label>Total Number of Tenor Statements:&nbsp;\n        <input [(ngModel)]=\"selected.parent.repetitions\" type=\"number\" min=\"1\">\n    </label>\n</div>\n<button color=primary class=\"primary-button\" *ngIf=\"selected\" mat-stroked-button (click)=\"finishStep()\">\n    Continue to Score Editor\n</button>\n","import { Component, OnInit } from '@angular/core';\nimport { StateService } from '../../state-service.service';\nimport { MatDialog } from '@angular/material/dialog';\nimport { System } from '../../utils/system';\nimport { InputService } from '../input.service';\n\nimport * as vkbeautify from 'vkbeautify';\n\n@Component({\n  selector: 'app-toolbar',\n  templateUrl: './toolbar.component.html',\n  styleUrls: ['./toolbar.component.css']\n})\nexport class ToolbarComponent implements OnInit {\n  currentStaff: System;\n\n  constructor(\n    private selectedSystem: InputService,\n    private stateService: StateService,\n    public dialog: MatDialog\n  ) { }\n\n  ngOnInit() {\n    this.selectedSystem.subscribe(system => {\n      this.currentStaff = system;\n    });\n  }\n\n  saveClick(evt: MouseEvent) {\n    let target = evt.target as HTMLAnchorElement;\n    const mei = this.stateService.mei.generateXML();\n    const serializer = new XMLSerializer();\n    const content = vkbeautify.xml(serializer.serializeToString(mei));\n    const blob = new Blob([content], {type: 'application/xml'});\n    target.setAttribute('href', window.URL.createObjectURL(blob));\n  }\n\n  saveHumdrumClick(evt: MouseEvent) {\n    let target = evt.target as HTMLAnchorElement;\n    const white = this.currentStaff.parent.parent.notationType === \"mensural.white\";\n    const content = this.currentStaff.contents.getHumdrumScore({white: white});\n    const blob = new Blob([content], {type: 'text/plain'});\n    target.setAttribute('href', window.URL.createObjectURL(blob));\n  }\n\n  deleteStaff() {\n    let system = this.currentStaff;\n    let part = system.parent;\n    part.removeSystem(system.id);\n    this.selectedSystem.next(null);\n  }\n\n}\n","<div class=\"toolbar-container\">\n    <button mat-stroked-button>\n        <a download type=\"application/xml\" (click)=\"saveClick($event)\">\n            Download MEI File\n        </a>\n    </button>\n    <button mat-stroked-button *ngIf=\"currentStaff\">\n        <a download type=\"text/plain\" (click)=\"saveHumdrumClick($event)\">\n            Download System Humdrum\n        </a>\n    </button>\n    <button mat-stroked-button *ngIf=\"currentStaff\" (click)=\"deleteStaff()\">\n        Delete Staff\n    </button>\n</div>\n","import { Injectable } from '@angular/core';\nimport { Subject } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DocService {\n  _partsSubject: Subject<XMLDocument>;\n  _scoreSubject: Subject<XMLDocument>;\n  _parts: XMLDocument;\n  _score: XMLDocument;\n\n  constructor() {\n    this._parts = null;\n    this._score = null;\n    this._partsSubject = new Subject<XMLDocument>();\n    this._scoreSubject = new Subject<XMLDocument>();\n  }\n\n  get parts(): XMLDocument {\n    return this._parts;\n  }\n\n  set parts(doc: XMLDocument) {\n    this._parts = doc;\n    this._partsSubject.next(this._parts);\n  }\n\n  get score(): XMLDocument {\n    return this._score;\n  }\n\n  set score(doc: XMLDocument) {\n    this._score = doc;\n    this._scoreSubject.next(this._score);\n  }\n}\n","import { Component, OnInit, OnDestroy, Input } from '@angular/core';\n\nimport { IRI } from '../../utils/definitions';\n\nimport { SelectedStaffService } from '../selected-staff.service';\n\nimport Diva from 'diva.js';\n\n@Component({\n  selector: 'app-score-diva-view',\n  templateUrl: './score-diva-view.component.html',\n  styleUrls: ['./score-diva-view.component.css']\n})\nexport class ScoreDivaViewComponent implements OnInit, OnDestroy {\n\n  diva: Diva;\n  pageToCanvasMap: Map<string, number> = new Map();\n  iri: IRI;\n  bbox: {ulx: string, uly: string, lrx: string, lry: string};\n\n  @Input() iiifManifest: IRI;\n\n  constructor(private staffService: SelectedStaffService) { }\n\n  ngOnInit() {\n    this.diva = new Diva('diva-score-wrapper', {\n      objectData: this.iiifManifest\n    });\n\n    Diva.Events.subscribe('ManifestDidLoad', this.parseCanvases.bind(this), this.diva.settings.ID);\n    Diva.Events.subscribe('ZoomLevelDidChange', this.handleZoom.bind(this), this.diva.settings.ID);\n\n    this.staffService.getStaffLocation().subscribe(([iri, bbox]) =>  {\n      this.iri = iri;\n      this.bbox = bbox;\n      console.debug(iri);\n      console.debug(bbox);\n      this.redraw();\n    });\n  }\n\n  handleZoom() {\n    (new Promise(resolve => {\n      document.getElementById(\"score-editor-container\").style.display = \"none\";\n      setTimeout(resolve, this.diva.settings.zoomDuration + 100);\n    })).then(() => {\n      this.redraw();\n      document.getElementById(\"score-editor-container\").style.display = \"\";\n    });\n  }\n\n  redraw() {\n    const index = this.pageToCanvasMap.get(this.iri);\n    if (index === undefined) {\n      return;\n    }\n    // Change to correct folio if necessary\n    if (!this.diva.getCurrentPageIndices().includes(index)) {\n      this.diva.gotoPageByIndex(index);\n    }\n    // Get the inner element and dimensions\n    const inner =this.diva.settings.innerElement;\n    const dimensions = this.diva.getPageDimensionsAtCurrentZoomLevel(index);\n    const offset = this.diva.settings.viewHandler._viewerCore.getPageRegion(\n      index,\n      {\n        includePadding: true,\n        incorporateViewport: true\n      }\n    );\n    const marginLeft = getComputedStyle(inner, null).getPropertyValue('margin-left');\n    // Check for the container div or create one\n    let container = document.getElementById(\"score-editor-container\");\n    if (container === null) {\n      container = document.createElement(\"div\");\n      container.id = \"score-editor-container\";\n      inner.appendChild(container);\n    }\n\n    // Create SVG container\n    const svgParent = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n    const maxZoom = this.diva.getPageDimensionsAtZoomLevel(index, Number.MAX_SAFE_INTEGER)\n    svgParent.setAttribute('width', dimensions.width.toString());\n    svgParent.setAttribute('height', dimensions.height.toString());\n    svgParent.setAttribute('viewBox', '0 0 ' + maxZoom.width + ' ' + maxZoom.height);\n\n    container.style.position = 'absolute';\n    container.style.top = `${offset.top}px`;\n    container.style.left = `${offset.left - parseInt(marginLeft)}px`;\n\n    while (container.firstChild !== null) {\n      container.firstChild.remove();\n    }\n\n    let rect = document.createElementNS(\"http://www.w3.org/2000/svg\", \"rect\");\n    rect.setAttribute(\"x\", this.bbox.ulx);\n    rect.setAttribute(\"y\", this.bbox.uly);\n    rect.setAttribute(\"width\", (Number(this.bbox.lrx) - Number(this.bbox.ulx)).toString());\n    rect.setAttribute(\"height\", (Number(this.bbox.lry) - Number(this.bbox.uly)).toString());\n    rect.classList.add(\"zoneRect\");\n    svgParent.appendChild(rect);\n\n    container.appendChild(svgParent);\n  }\n\n  parseCanvases(manifest: { sequences: { canvases: object[] }[]}) {\n    for (const sequence of manifest.sequences) {\n      for (const canvas of sequence.canvases) {\n        this.pageToCanvasMap.set(canvas['@id'], sequence.canvases.indexOf(canvas));\n      }\n    }\n  }\n\n  ngOnDestroy() {\n    try {\n      this.diva.deactivate();\n      this.diva.destroy();\n    }\n    catch (e) {\n      console.warn(e);\n    }\n  }\n\n}\n","<div id=\"diva-score-wrapper\"></div>\n","import { Component, OnInit } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\n\nimport { IRI } from '../utils/definitions';\nimport { StateService } from '../state-service.service';\nimport { MEIDocument } from '../utils/mei';\nimport { formIIIFManifest } from '../tools';\n\n@Component({\n  selector: 'app-score-editor',\n  templateUrl: './score-editor.component.html',\n  styleUrls: ['./score-editor.component.css']\n})\nexport class ScoreEditorComponent implements OnInit {\n\n  source: string;\n  identifier: string;\n  iiifManifest: IRI;\n  meiDoc: MEIDocument;\n\n  constructor(\n    private router: Router,\n    private route: ActivatedRoute,\n    private stateService: StateService\n  ) {\n    this.source = this.route.snapshot.paramMap.get('source');\n    this.identifier = decodeURIComponent(\n      this.route.snapshot.paramMap.get('identifier')\n    );\n    this.iiifManifest = formIIIFManifest(this.source, this.identifier);\n    this.meiDoc = this.stateService.mei;\n    if (this.meiDoc === null) {\n      this.router.navigate(['/input', this.source, this.identifier])\n    }\n  }\n\n  ngOnInit() {\n  }\n}\n","<div id=\"score-container\">\n    <app-score-diva-view [iiifManifest]=\"iiifManifest\"></app-score-diva-view>\n    <div id=\"right\">\n        <mat-tab-group>\n            <mat-tab label=\"Score Editor\">\n                <app-score-toolbar></app-score-toolbar>\n                <mat-divider></mat-divider>\n                <app-score-verovio-view></app-score-verovio-view>\n            </mat-tab>\n            <mat-tab label=\"Score Editor Help\">\n                <h2>About the Score Editor</h2>\n                <p>\n                    The <strong>Score Editor</strong> is for making simple edits\n                    in order to align the parts in your score. In other words,\n                    if you made mistakes in your initial entry of the music on\n                    the previous screen (the <strong>Music Input</strong> screen)\n                    the score will not align properly and you may need to make adjustments\n                    to the note durations or add dots in order to get the proper alignment.\n                </p>\n                <mat-divider></mat-divider>\n                <h2>Making Simple Edits</h2>\n                <p>\n                    When you click on a pitch, the staff to which\n                    that pitch belongs will be highlighted with a\n                    dashed box in the manuscript image in the left\n                    of the screen. This is to help you check\n                    the accuracy of the edits you make.\n                </p>\n                <p>\n                    You can make simple edits directly as follows.\n                    By clicking on a pitch to highlight it you can edit:\n                </p>\n                <ul>\n                    <li><strong>Pitch: </strong>\n                        Use up/down arrow keys to change pitch.\n                    </li>\n                    <li><strong>Rhythm: </strong>\n                        Type a number key to alter its rhythm\n                        (1 semibreve, 2 minim, 4 semiminim,\n                        8 fusa, 6 semifusa, 0 breve, 9 long, 7 maxima).\n                        Scoring-up will rerun after a rhythmic value changes.\n                    </li>\n                    <li><strong>Dots: </strong>\n                        Typing a period will add or remove the dot from the\n                        highlighted pitch. Scoring-up will automatically\n                        rerun.\n                    </li>\n                    <li><strong>Accidentals: </strong>\n                        To add a flat, press <code>-</code>.\n                        To add a sharp, press <code>#</code>.\n                        To add a natural, press <code>n</code>.\n                        To clear accidentals, press <code>N</code>.\n                    </li>\n                    <li><strong>Cloning and Deleting Elements: </strong>\n                        Elements can be cloned by selecting one and pressing the\n                        <code>I</code> key. Elements can be deleted by pressing\n                        <code>Backspace</code>.\n                    </li>\n                </ul>\n                <p>\n                    You can also use the \"Return to Music Input\" button to return\n                    to the <strong>Music Input</strong> screen\n                    and make more significant edits, but any changes made\n                    in the <strong>Score Editor</strong> thus far will be lost!\n                </p>\n                <mat-divider></mat-divider>\n                <h2>Moving to Editorial Mode</h2>\n                <p>\n                    When making corrections in the <strong>Score Editor</strong>\n                    it is assumed that you are correcting mistakes <em>you</em>\n                    made, and both the MEI Parts and MEI Score files will be updated\n                    with these changes. However, once you move to <strong>Editorial Mode</strong>,\n                    the MEI Parts file will no longer be updated since this is a record\n                    of the music <em>exactly</em> as it was recorded in the original\n                    manuscript. Any further corrections made in <strong>Editorial\n                    Mode</strong> will be encoded in the MEI Score file as\n                    <strong>editorial</strong> corrections. For example, when a\n                    dot is added in <strong>Editorial Mode</strong>:\n                </p>\n                <pre><code>\n                    &lt;choice&gt;\n                        &lt;corr&gt;\n                            &lt;note dur=&quot;semibrevis&quot; oct=&quot;3&quot; pname=&quot;a&quot; dur.quality=&quot;minor&quot;/&gt;\n                            &lt;dot form=&quot;div&quot;/&gt;\n                        &lt;/corr&gt;\n                        &lt;sic&gt;\n                            &lt;note dur=&quot;semibrevis&quot; oct=&quot;3&quot; pname=&quot;a&quot;/&gt;\n                        &lt;/sic&gt;\n                    &lt;/choice&gt;\n                </code></pre>\n                <mat-divider></mat-divider>\n                <p>\n                    The purpose of the <strong>Score Editor</strong> is to do enough editing to\n                    enable the correct alignment of the score and edit while\n                    viewing the manuscript. For more fine-grained editing,\n                    it is recommended to download the MEI file and open it\n                    in a tool that allows direct editing of the MEI file such\n                    as <a href=\"https://verovio.humdrum.org\" target=\"_blank\">\n                    the Verovio Humdrum Viewer</a> or <a href=\"https://editor.verovio.org\"\n                    target=\"_blank\">the Verovio Editor</a>.\n                </p>\n            </mat-tab>\n        </mat-tab-group>\n    </div>\n</div>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatDividerModule } from '@angular/material/divider';\nimport { MatTabsModule } from '@angular/material/tabs';\n\nimport { ScoreEditorComponent } from './score-editor.component';\nimport { ScoreDivaViewComponent } from './score-diva-view/score-diva-view.component';\nimport { ScoreVerovioViewComponent } from './score-verovio-view/score-verovio-view.component';\nimport { ScoreToolbarComponent } from './score-toolbar/score-toolbar.component';\n\n@NgModule({\n  declarations: [\n    ScoreDivaViewComponent,\n    ScoreVerovioViewComponent,\n    ScoreEditorComponent,\n    ScoreToolbarComponent\n  ],\n  imports: [\n    CommonModule,\n    FormsModule,\n    MatButtonModule,\n    MatDividerModule,\n    MatTabsModule,\n  ],\n  exports: [\n    ScoreEditorComponent\n  ]\n})\nexport class ScoreEditorModule { }\n","import { Component, OnInit } from '@angular/core';\nimport { Router, ActivatedRoute } from '@angular/router';\n\nimport { refineScore } from 'scoring-up';\nimport * as vkbeautify from 'vkbeautify';\n\nimport { StateService } from '../../state-service.service';\nimport { DocService } from '../doc.service';\n\n@Component({\n  selector: 'app-score-toolbar',\n  templateUrl: './score-toolbar.component.html',\n  styleUrls: ['./score-toolbar.component.css']\n})\nexport class ScoreToolbarComponent implements OnInit {\n\n  currentDoc: XMLDocument = null;\n\n  constructor(public stateService: StateService,\n    private route: ActivatedRoute,\n    private router: Router,\n    private doc: DocService\n  ) { }\n\n  ngOnInit() {\n    this.doc._scoreSubject.subscribe((doc) => {\n      this.currentDoc = doc;\n    });\n  }\n\n  saveClick(event: MouseEvent) {\n    if (this.currentDoc !== null) {\n      const target = event.target as HTMLAnchorElement;\n      const refinedDoc = refineScore(\n        this.currentDoc.cloneNode(true),\n        this.stateService.scoreOptions.modernClefs,\n        this.stateService.scoreOptions.barlines\n      );\n      const serializer = new XMLSerializer();\n      const content = vkbeautify.xml(serializer.serializeToString(refinedDoc));\n      const blob = new Blob([content], {type: 'application/xml'});\n      target.setAttribute('href', URL.createObjectURL(blob));\n    }\n  }\n\n  savePartsClick(event: MouseEvent) {\n    if (this.stateService.mei != null) {\n      const target = event.target as HTMLAnchorElement;\n      const serializer = new XMLSerializer();\n      const content = vkbeautify.xml(serializer.serializeToString(this.doc.parts));\n      const blob = new Blob([content], {type: 'application/xml'});\n      target.setAttribute('href', URL.createObjectURL(blob));\n    }\n  }\n\n  goToInputEditor() {\n    if (confirm(\"Warning: Edits made on this page will be lost. Return to input editor?\")) {\n      let source = this.route.snapshot.paramMap.get('source');\n      let identifier = this.route.snapshot.paramMap.get('identifier');\n      this.router.navigate(['/input', source, identifier]);\n    }\n  }\n\n  copyToClipboard() {\n    if (this.currentDoc !== null) {\n      const serializer = new XMLSerializer();\n      const refinedDoc = refineScore(\n        this.currentDoc.cloneNode(true),\n        this.stateService.scoreOptions.modernClefs,\n        this.stateService.scoreOptions.barlines\n      );\n      const content = vkbeautify.xml(serializer.serializeToString(refinedDoc));\n      navigator.clipboard.writeText(content).then(() => { alert(\"MEI Score Copied!\"); }).catch(err => { console.debug(err); alert(\"Copy failed :(\"); });\n    }\n  }\n\n}\n","<div class=\"toolbar-container\">\n    <button mat-stroked-button (click)=\"goToInputEditor()\">\n        Return to Music Input\n    </button>\n    <button mat-stroked-button>\n        <a download type=\"application/xml\" (click)=\"saveClick($event)\">\n            Download MEI Score\n        </a>\n    </button>\n    <button mat-stroked-button>\n        <a download type=\"application/xml\" (click)=\"savePartsClick($event)\">\n            Download MEI Parts\n        </a>\n    </button>\n    <button mat-stroked-button (click)=\"copyToClipboard()\">\n        Copy MEI Score to Clipboard\n    </button>\n</div>\n","import { Component, OnInit, AfterViewInit, HostListener, ViewChild, ElementRef } from '@angular/core';\n\nimport { v4 as uuid } from 'uuid';\n\nimport * as ScoringUp from 'scoring-up';\nimport { vrvToolkit } from '../../utils/verovio';\nimport { StateService } from '../../state-service.service';\nimport { SelectedStaffService } from '../selected-staff.service';\nimport { DocService } from '../doc.service';\n\nconst pnameOrder = [ 'c', 'd', 'e', 'f', 'g', 'a', 'b'];\n\nfunction recurseXmlId(element: Element) {\n  if (element.hasAttribute('xml:id')) {\n    element.setAttribute('xml:id', 'm-' + uuid());\n  }\n  for (let i = 0; i < element.children.length; i++) {\n    recurseXmlId(element.children[i]);\n  }\n}\n\n@Component({\n  selector: 'app-score-verovio-view',\n  templateUrl: './score-verovio-view.component.html',\n  styleUrls: ['./score-verovio-view.component.css']\n})\nexport class ScoreVerovioViewComponent implements OnInit, AfterViewInit {\n\n  @ViewChild('verovio') container: ElementRef;\n\n  selectedId: string = null;\n  quasiScore: XMLDocument = null;\n  corrToSicMap: Map<string, string> = new Map();\n\n  constructor(\n    public stateService: StateService,\n    private staffService: SelectedStaffService,\n    private doc: DocService\n  ) {  }\n\n  ngOnInit() {\n    this.doc.parts = this.stateService.mei.generateXML();\n    this.doc._scoreSubject.subscribe((doc) => {\n      this.container.nativeElement.innerHTML = '';\n      const svg = vrvToolkit.meiToSVG(doc);\n      this.container.nativeElement.appendChild(svg);\n      this.setSelected();\n    });\n  }\n\n  setEditorialMode() {\n    if (confirm(\"Edits in editorial mode reflect cases where there is a problem with the manuscript. You cannot exit editorial mode. Do you want to continue?\")) {\n      this.stateService.editorialMode = true;\n    }\n  }\n\n  setSelected() {\n    if (this.selectedId !== null) {\n      Array.from(document.getElementsByClassName(\"selected\"))\n        .forEach(elem => {\n          elem.classList.remove(\"selected\");\n          elem.setAttribute(\"fill\", \"\");\n        });\n      try {\n        document.getElementById(this.selectedId).classList.add(\"selected\");\n        document.getElementById(this.selectedId).setAttribute(\"fill\", \"#d00\");\n      }\n      catch (_e) {\n        console.debug(_e);\n        this.selectedId = null;\n        return;\n      }\n      try {\n        // Convert ID to sic ID if applicable\n        let partsId = this.selectedId;\n        if (this.corrToSicMap.has(partsId)) {\n          partsId = this.corrToSicMap.get(partsId);\n        }\n        // Get nearest pb  and sb\n        const resolver = this.doc.parts.createNSResolver(this.doc.parts.ownerDocument == null ? this.doc.parts.documentElement : this.doc.parts.ownerDocument.documentElement);\n        const meiRes = () => { return 'http://www.music-encoding.org/ns/mei'; };\n        const ref = this.doc.parts.evaluate(\"//*[@xml:id='\" + partsId + \"']\", this.doc.parts, resolver, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;\n        let result = this.doc.parts.evaluate(\"./preceding::mei:pb\", ref, meiRes, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);\n        const pb = result.snapshotItem(result.snapshotLength - 1) as Element;\n        result = this.doc.parts.evaluate(\"./preceding::mei:sb\", ref, meiRes, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);\n        const sb = result.snapshotItem(result.snapshotLength - 1) as Element;\n        // Get corresponding zones (strip away fragment symbol)\n        const pbFacsId = pb.getAttribute(\"facs\")[0] === \"#\" ?\n          pb.getAttribute(\"facs\").substring(1) :\n          pb.getAttribute(\"facs\");\n        const sbFacsId = sb.getAttribute(\"facs\")[0] === \"#\" ?\n          sb.getAttribute(\"facs\").substring(1) :\n          sb.getAttribute(\"facs\");\n        console.debug(sbFacsId);\n\n        // The following SHOULD use XPath but I haven't been able to get it to work\n        const pbGraphic = Array.from(\n          this.doc.parts.getElementsByTagName(\"surface\")\n        ).filter(el => { return el.getAttribute(\"xml:id\") === pbFacsId; }).pop()\n          .querySelector(\"graphic\");\n        const sbZone = Array.from(\n          pbGraphic.children\n        ).filter(el => { return el.getAttribute(\"xml:id\") === sbFacsId; }).pop()\n        const iri = pbGraphic.getAttribute(\"target\");\n        const bbox = {\n          ulx: sbZone.getAttribute(\"ulx\"),\n          uly: sbZone.getAttribute(\"uly\"),\n          lrx: sbZone.getAttribute(\"lrx\"),\n          lry: sbZone.getAttribute(\"lry\")\n        };\n        console.debug(iri);\n        this.staffService.staffLocation = [iri, bbox];\n      }\n      catch (_e) {\n        console.debug(_e);\n      }\n    }\n  }\n\n  ngAfterViewInit() {\n    this.doc.score = this.runScoringUp(this.doc.parts);\n  }\n\n  handleClick(event: MouseEvent) {\n    let target = event.target as Element;\n    while (target) {\n      if (target.nodeName === 'g') {\n        if (target.classList.contains('note') || target.classList.contains('rest')) {\n          this.selectedId = target.id;\n          this.setSelected();\n          break;\n        }\n      }\n      target = target.parentElement;\n    }\n  }\n\n  @HostListener('document:keydown', ['$event'])\n  handleKeyPress(event: KeyboardEvent) {\n    if (this.selectedId !== null) {\n      let doc: XMLDocument;\n      if (this.stateService.editorialMode) {\n        if (this.quasiScore === null) {\n          this.quasiScore = this.getQuasiScore(this.doc.parts);\n        }\n        doc = this.quasiScore;\n      }\n      else {\n        doc = this.doc.parts;\n      }\n      const resolver = this.doc.parts.createNSResolver(this.doc.parts.ownerDocument == null ? this.doc.parts.documentElement : this.doc.parts.ownerDocument.documentElement);\n      const result = this.doc.parts.evaluate(\"//*[@xml:id='\" + this.selectedId + \"']\", this.doc.parts, resolver, XPathResult.FIRST_ORDERED_NODE_TYPE, null);\n      if (!result.singleNodeValue) return;\n      let target = result.singleNodeValue as Element;\n      // Ensure corrected element in MEI\n      if (this.stateService.editorialMode) {\n        target = this.ensureCorrElement(target, this.doc.parts);\n      }\n      if (target.tagName === \"note\") {\n        switch (event.key) {\n          case '.':\n            let sibling = target.nextElementSibling;\n            if (sibling !== null && sibling.tagName === 'dot') {\n              target.nextSibling.remove();\n              if (target.hasAttribute(\"dots\")) {\n                target.setAttribute(\"dots\", \"0\");\n              }\n            }\n            else {\n              let dot = this.doc.parts.createElementNS(\"http://www.music-encoding.org/ns/mei\", \"dot\");\n              dot.setAttribute(\"xml:id\", \"m-\" + uuid());\n              target.insertAdjacentElement(\"afterend\", dot);\n            }\n            break;\n          case 'ArrowUp':\n            if (target.hasAttribute('pname')) {\n              let currentPname = target.getAttribute('pname');\n              let idx = pnameOrder.indexOf(currentPname);\n              if (idx + 1 < pnameOrder.length) {\n                target.setAttribute('pname', pnameOrder[idx + 1]);\n              }\n              else {\n                target.setAttribute('pname', pnameOrder[0]);\n                target.setAttribute('oct', (parseInt(target.getAttribute('oct')) + 1).toString());\n              }\n            }\n            break;\n          case 'ArrowDown':\n            if (target.hasAttribute('pname')) {\n              let currentPname = target.getAttribute('pname');\n              let idx = pnameOrder.indexOf(currentPname);\n              if (idx - 1 > 0) {\n                target.setAttribute('pname', pnameOrder[idx - 1]);\n              }\n              else {\n                target.setAttribute('pname', pnameOrder[pnameOrder.length - 1]);\n                target.setAttribute('oct', (parseInt(target.getAttribute('oct')) - 1).toString());\n              }\n            }\n            break;\n          case '1': target.setAttribute('dur', 'semibrevis'); break;\n          case '2': target.setAttribute('dur', 'minima'); break;\n          case '4': target.setAttribute('dur', 'semiminima'); break;\n          case '8': target.setAttribute('dur', 'fusa'); break;\n          case '6': target.setAttribute('dur', 'semifusa'); break;\n          case '7': target.setAttribute('dur', 'maxima'); break;\n          case '9': target.setAttribute('dur', 'longa'); break;\n          case '0': target.setAttribute('dur', 'brevis'); break;\n\n          case '#': target.setAttribute('accid', 's'); break;\n          case '-': target.setAttribute('accid', 'f'); break;\n          case 'n': target.setAttribute('accid', 'n'); break;\n          case 'N': target.removeAttribute('accid'); break;\n\n          case 'I':\n            const clone = target.cloneNode(true) as Element;\n            recurseXmlId(clone);\n            if (target.nextElementSibling && target.nextElementSibling.tagName === 'dot') {\n              const cloneDot = target.nextElementSibling.cloneNode(true) as Element;\n              recurseXmlId(cloneDot);\n              target.nextElementSibling.insertAdjacentElement('afterend', clone);\n              clone.insertAdjacentElement('afterend', cloneDot);\n            }\n            else {\n              target.insertAdjacentElement('beforebegin', clone);\n            }\n            break;\n          case 'Backspace':\n            if (target.nextElementSibling && target.nextElementSibling.tagName === 'dot') {\n              target.nextElementSibling.remove();\n            }\n            target.remove();\n\n            break;\n          default:\n            return;\n        }\n      } else if (target.tagName === \"rest\") {\n        switch (event.key) {\n          case '1': target.setAttribute('dur', 'semibrevis'); break;\n          case '2': target.setAttribute('dur', 'minima'); break;\n          case '4': target.setAttribute('dur', 'semiminima'); break;\n          case '8': target.setAttribute('dur', 'fusa'); break;\n          case '6': target.setAttribute('dur', 'semifusa'); break;\n          case '7': target.setAttribute('dur', 'maxima'); break;\n          case '9': target.setAttribute('dur', 'longa'); break;\n          case '0': target.setAttribute('dur', 'brevis'); break;\n\n          case 'I':\n            const clone = target.cloneNode(true) as Element;\n            recurseXmlId(clone);\n            target.insertAdjacentElement('beforebegin', clone);\n            break;\n\n          case 'Backspace':\n            target.remove();\n            break;\n\n          default:\n            return;\n        }\n      }\n\n      event.preventDefault();\n      this.doc.score = this.runScoringUp(this.doc.parts);\n    }\n  }\n\n  runScoringUp(meiDoc: XMLDocument): XMLDocument {\n    let output = null;\n    try {\n      const staffDef = meiDoc.getElementsByTagName(\"staffDef\")[0];\n      let quasiDoc: XMLDocument;\n      if (this.stateService.editorialMode) {\n        quasiDoc = this.quasiScore.cloneNode(true) as XMLDocument;\n      }\n      else {\n        quasiDoc = ScoringUp.merge(meiDoc.cloneNode(true));\n      }\n      switch (staffDef.getAttribute(\"notationtype\")) {\n        case \"mensural.white\":\n          output = ScoringUp.ArsNova.lining_up(quasiDoc);\n          break;\n        case \"mensural.black\":\n          switch(staffDef.getAttribute(\"notationsubtype\")) {\n            case \"Ars_antiqua\":\n              output = ScoringUp.ArsAntiqua.lining_up(quasiDoc);\n              break;\n            case \"Ars_nova\":\n              output = ScoringUp.ArsNova.lining_up(quasiDoc);\n              break;\n            default:\n              console.warn(\"Only 'Ars antiqua' and 'Ars nova' are supported!\");\n          }\n          break;\n        default:\n          console.warn(\"Only mensural notation types are supported.\");\n          break;\n      }\n      if (output !== null) {\n        ScoringUp.PostProcessing.replace_ligatures_by_brackets(output);\n        // ScoringUp.PostProcessing.remove_num_and_numbase(output);\n      }\n    }\n    catch(e) {\n      console.error(e);\n      alert(\"Error in scoring up tool! \" + e);\n      output = null;\n    }\n    finally {\n      return output;\n    }\n  }\n\n  getQuasiScore(partsMEI: XMLDocument): XMLDocument {\n    let quasi = null;\n    try {\n      quasi = ScoringUp.merge(partsMEI.cloneNode(true));\n    } catch (e) {\n      console.error(e);\n    }\n    return quasi;\n  }\n\n  ensureCorrElement(target: Element, meiDoc: XMLDocument): Element {\n    if (target.closest('corr')) {\n      return target;\n    }\n    const choice = meiDoc.createElementNS('http://www.music-encoding.org/ns/mei', 'choice');\n    const corr = meiDoc.createElementNS('http://www.music-encoding.org/ns/mei', 'corr');\n    const sic = meiDoc.createElementNS('http://www.music-encoding.org/ns/mei', 'sic');\n    const sibling = target.nextElementSibling;\n    target.insertAdjacentElement('beforebegin', choice);\n    choice.appendChild(corr);\n    choice.appendChild(sic);\n    sic.appendChild(target);\n    const corrTarget = target.cloneNode(true) as Element;\n    recurseXmlId(corrTarget);\n    corr.appendChild(corrTarget);\n    this.corrToSicMap.set(corrTarget.getAttribute(\"xml:id\"), target.getAttribute(\"xml:id\"));\n    if (sibling !== null && sibling.tagName === 'dot') {\n      sic.appendChild(sibling);\n      const sibCorr = sibling.cloneNode(true) as Element;\n      recurseXmlId(sibCorr);\n      corr.appendChild(sibCorr);\n    }\n    return corrTarget;\n  }\n}\n","<div id=\"verovio\" #verovio (click)=\"handleClick($event)\"></div>\n<div>\n    <label>\n        Generate Barlines on Export\n        <input type=\"checkbox\" [(ngModel)]=\"stateService.scoreOptions.barlines\">\n    </label>\n    &nbsp;\n    <label>\n        Switch to Modern Clefs on Export\n        <input type=\"checkbox\" [(ngModel)]=\"stateService.scoreOptions.modernClefs\">\n    </label>\n</div>\n<div>\n    <button color=primary class=\"primary-button\" mat-stroked-button *ngIf=\"!stateService.editorialMode\" (click)=\"setEditorialMode()\">\n        Continue in Editorial Mode\n    </button>\n</div>\n","import { Injectable } from '@angular/core';\nimport { Subject } from 'rxjs';\nimport { IRI } from '../utils/definitions';\n\ntype BBox = {\n  ulx: string,\n  uly: string,\n  lrx: string,\n  lry: string\n};\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SelectedStaffService {\n  _staffLoc: Subject<[IRI, BBox]>;\n\n  constructor() {\n    this._staffLoc = new Subject<[IRI, BBox]>();\n  }\n\n  getStaffLocation() {\n    return this._staffLoc;\n  }\n\n  set staffLocation(loc: [IRI, BBox]) {\n    this._staffLoc.next(loc);\n  }\n\n\n}\n","import { Component, OnInit } from '@angular/core';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { RxwebValidators } from '@rxweb/reactive-form-validators';\nimport { Router } from '@angular/router';\n\nimport { MEIDocument } from '../utils/mei';\nimport { StateService } from '../state-service.service';\nimport * as Tools from '../tools';\n\n@Component({\n  selector: 'app-select-document',\n  templateUrl: './select-document.component.html',\n  styleUrls: ['./select-document.component.css']\n})\nexport class SelectDocumentComponent implements OnInit {\n\n  type: string = 'gallica';\n  identifier: string = '12148/btv1b8454675g';\n  file: File = null;\n\n  invalid = false;\n\n  selectionForm = new FormGroup({\n    source: new FormControl('gallica', Validators.required),\n    resourceURL: new FormControl('', [Validators.required, RxwebValidators.url()])\n  });\n\n  loadMEIForm = new FormGroup({\n    fileInput: new FormControl('', Validators.required)\n  });\n\n  constructor(private router: Router, private stateService: StateService) { }\n\n  ngOnInit() {\n  }\n\n  submit() {\n    console.debug(\"Submit\");\n    let source = this.selectionForm.controls['source'].value;\n    let resourceURL = this.selectionForm.controls['resourceURL'].value;\n    this.invalid = false;\n    let identifier: string;\n    switch (source) {\n      case 'gallica':\n        console.debug(\"gallica\");\n        if (Tools.gallicaRegexp.test(resourceURL)) {\n          console.debug(\"true\");\n          identifier = resourceURL.match(Tools.gallicaRegexp)[1];\n        }\n        else {\n          console.debug(\"false\");\n          this.invalid = true;\n          return;\n        }\n        break;\n      case 'ecodices':\n        if (Tools.ecodicesRegexp.test(resourceURL)) {\n          console.debug(\"Regular ecodices\");\n          let matches = resourceURL.match(Tools.ecodicesRegexp);\n          identifier = matches[1] + '-' + matches[2];\n        }\n        else if (Tools.ecodicesIIIFRegexp.test(resourceURL)) {\n          console.debug(\"IIIF ecodices\");\n          identifier = resourceURL.match(Tools.ecodicesIIIFRegexp)[1];\n        }\n        else {\n          this.invalid = true;\n          return;\n        }\n        break;\n      case 'iiif':\n        console.debug('iiif case')\n        if (Tools.genericIIIFRegexp.test(resourceURL)) {\n          console.debug(\"generic iiif\");\n          identifier = encodeURIComponent(resourceURL);\n        }\n        break;\n      default:\n        console.debug(source);\n        this.invalid = true;\n        return;\n    }\n    console.debug(identifier);\n    this.router.navigate(['/input', source, encodeURIComponent(identifier)]);\n  }\n\n  meiSubmit() {\n    console.debug(\"MEI Submit\");\n    console.debug(this.file);\n    if (this.file === null) { return; }\n    let reader = new FileReader();\n    reader.addEventListener(\"load\", () => {\n      let rawText = reader.result as string;\n      let parser = new DOMParser();\n      let doc = parser.parseFromString(rawText, \"application/xml\");\n      let mei = MEIDocument.fromXML(doc)\n      console.debug(mei);\n\n      // Try to determine IIIF\n      let iiif = mei.metadata.sourceIRI;\n      let source: string, identifier: string;\n      if (Tools.gallicaIIIFRegexp.test(iiif)) {\n        source = \"gallica\";\n        identifier = iiif.match(Tools.gallicaIIIFRegexp)[1];\n      }\n      else if (Tools.ecodicesIIIFRegexp.test(iiif)) {\n        source = \"ecodices\";\n        identifier = iiif.match(Tools.ecodicesIIIFRegexp)[1];\n      }\n      else if (Tools.genericIIIFRegexp.test(iiif)) {\n        source = \"iiif\";\n        identifier = encodeURIComponent(iiif);\n      }\n      else {\n        window.alert(\"Sorry! This seems to be a valid file, but this IIIF manifest cannot be loaded.\");\n        return;\n      }\n      this.stateService.mei = mei;\n      this.router.navigate(['/input', source, encodeURIComponent(identifier)]);\n    });\n    reader.readAsText(this.file);\n  }\n\n  onFileChange(evt) {\n    this.file = evt.target['files'][0];\n  }\n\n  get encodedIdSample(): string {\n    return encodeURIComponent(this.identifier);\n  }\n\n}\n","<div id=\"document-select\">\n    <div id=\"load-manuscript\">\n        <h1>Load Manuscript</h1>\n        <form [formGroup]=\"selectionForm\" (submit)=\"submit()\">\n            <div style=\"display:block;\">\n                <label class=\"label\">Manuscript Repository:&nbsp;\n                    <select formControlName=\"source\">\n                        <option value=\"gallica\" selected>Gallica</option>\n                        <option value=\"ecodices\">eCodices</option>\n                        <option value=\"diamm\" disabled>DIAMM</option>\n                        <option value=\"iiif\">Generic IIIF</option>\n                    </select>\n                </label>\n                &nbsp;\n                <label class=\"label\">URL:&nbsp;\n                    <input type=\"url\" formControlName=\"resourceURL\">\n                </label>\n                <small *ngIf=\"invalid\">URL is unexpected for this source!</small>\n            </div>\n            <div>\n                <button type=\"submit\" [disabled]=\"!selectionForm.valid\" mat-stroked-button>Submit</button>\n            </div>\n        </form>\n        <br/><br/>\n        <a [routerLink]=\"['/input', 'gallica', encodedIdSample]\">\n            <button color=primary class=\"primary-button\" mat-stroked-button>Use Sample Document</button>\n        </a>\n    </div>\n    <div id=\"load-mei\">\n        <h1>Load from Parts MEI</h1>\n        <form [formGroup]=\"loadMEIForm\" (submit)=\"meiSubmit()\">\n            <div style=\"display:block;\">\n                <label class=\"label\">Compatible Parts-MEI File:&nbsp;\n                    <input type=\"file\" (change)=\"onFileChange($event)\" formControlName=\"fileInput\" accept=\"application/mei+xml, application/xml, .mei, .xml\">\n                </label>\n            </div>\n            <div>\n                <button type=\"submit\" [disabled]=\"!loadMEIForm.valid\" mat-stroked-button>Load File</button>\n            </div>\n        </form>\n    </div>\n</div>\n","import { Injectable } from '@angular/core';\nimport { MEIDocument } from './utils/mei';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class StateService {\n\n  private meiDoc: MEIDocument;\n  public editorialMode: boolean;\n  public scoreOptions: {\n    barlines: boolean,\n    modernClefs: boolean\n  };\n\n  constructor() {\n    this.meiDoc = null;\n    this.editorialMode = false;\n    this.scoreOptions = {\n      barlines: false,\n      modernClefs: false\n    };\n  }\n\n  get mei(): MEIDocument {\n    return this.meiDoc;\n  }\n\n  set mei(document: MEIDocument) {\n    this.meiDoc = document;\n  }\n}\n","import { IRI } from './utils/definitions';\n\nexport function formIIIFManifest(source: string, identifier: string): IRI {\n  switch (source) {\n    case 'gallica':\n      return 'https://gallica.bnf.fr/iiif/ark:/' +\n        identifier +\n        '/manifest.json';\n    case 'ecodices':\n      return 'https://www.e-codices.unifr.ch/metadata/iiif/' +\n        identifier +\n        '/manifest.json';\n    case 'iiif':\n      return decodeURIComponent(identifier);\n    default:\n      return '';\n  }\n}\n\n//https://gallica.bnf.fr/ark:/12148/btv1b8454675g\nexport const gallicaRegexp = new RegExp(\"https?:\\/\\/gallica\\.bnf\\.fr\\/ark:\\/([a-z0-9]+\\/[a-z0-9]+)\");\nexport const gallicaIIIFRegexp = new RegExp(\"https?:\\/\\/gallica\\.bnf\\.fr\\/iiif\\/ark:\\/([a-z0-9]+\\/[a-z0-9]+)\\/manifest.json\");\n//https://www.e-codices.unifr.ch/en/list/one/bbb/0218\nexport const ecodicesRegexp = new RegExp(\"https?:\\/\\/www\\.e-codices\\.unifr\\.ch\\/[a-z]{2}\\/list\\/one\\/([a-z]+)\\/([-a-zA-Z0-9]+)\");\n//https://www.e-codices.unifr.ch/metadata/iiif/bbb-0218/manifest.json\nexport const ecodicesIIIFRegexp = new RegExp(\"https?:\\/\\/www\\.e-codices\\.unifr\\.ch\\/metadata\\/iiif\\/([-a-zA-Z0-9]+)\\/manifest\\.json\");\nexport const genericIIIFRegexp = new RegExp(\"https?:\\/\\/.*\\/manifest\\.json\");\n","/**\n * Based on musiclist.js by Craig Sapp\n * From: https://github.com/craigsapp/mensural-input/blob/master/scripts/musiclist.js\n */\n\nimport { v4 } from \"uuid\";\nimport { Mensuration } from './definitions';\n\nfunction parseRhythm(rhythm: string): number {\n  let val: number;\n  switch (rhythm) {\n    case \"semibrevis\": val = 1; break;\n    case \"brevis\": val = 0; break;\n    case \"maxima\": val = 7; break;\n    case \"longa\": val = 9; break;\n    case \"minima\": val = 2; break;\n    case \"semiminima\": val = 4; break;\n    case \"fusa\": val = 8; break;\n    case \"semifusa\": val = 6; break;\n  }\n  return val;\n}\n\nexport enum PitchClass {\n  C = 0,\n  D = 1,\n  E = 2,\n  F = 3,\n  G = 4,\n  A = 5,\n  B = 6,\n}\n\nexport enum Accid {\n  NONE,\n  SHARP = \"#\",\n  FLAT = \"-\",\n  NATURAL = \"n\",\n}\n\nexport enum LigStatus {\n  NONE,\n  START,\n  END,\n}\n\nexport enum PlicaStatus {\n  NONE,\n  UP,\n  DOWN,\n}\n\nexport interface MusicItem {\n  m_type: string;\n  m_id: string;\n  m_line: number;\n  getHumdrumLine(options: object): string;\n}\n\nexport class ClefItem implements MusicItem {\n  readonly m_type = \"clef\";\n  m_line = -1;\n  m_id: string;\n  m_pname: PitchClass;\n  m_clefLine: number;\n  m_keySig: Map<string,string>;\n\n  constructor () {\n    this.m_pname = PitchClass.C;\n    this.m_clefLine = 3;\n    this.m_keySig = new Map();\n  }\n\n  raisePitch () {\n    this.m_clefLine += 1;\n    if (this.m_clefLine > 5) {\n      this.m_clefLine = 5;\n    }\n  }\n\n  lowerPitch () {\n    this.m_clefLine -= 1;\n    if (this.m_clefLine < 1) {\n      this.m_clefLine = 1;\n    }\n  }\n\n  getHumdrumLine(): string {\n    let output = \"*clef\";\n    switch (this.m_pname) {\n      case PitchClass.G: output += \"G\"; break;\n      case PitchClass.F: output += \"F\"; break;\n      default: output += \"C\"; break;\n    }\n    output += this.m_clefLine;\n    output += \"\\t\";\n    output += \"*\";\n    if (this.m_keySig.size > 0) {\n      output += \"\\n\";\n      output += \"*k[\";\n      for (let [pitch, accid] of this.m_keySig) {\n        output += pitch;\n        output += accid;\n      }\n      output += \"]\\t*\";\n    }\n    return output;\n  }\n\n  static parseXML(element: Element): ClefItem {\n    let clef = new ClefItem();\n    if (element.hasAttribute(\"xml:id\")) {\n      clef.m_id = element.getAttribute(\"xml:id\");\n    }\n    switch (element.getAttribute(\"shape\")) {\n      case \"F\": clef.m_pname = PitchClass.F; break;\n      case \"G\": clef.m_pname = PitchClass.G; break;\n      case \"C\":\n      default: break;\n    }\n    try {\n      let line: number = parseInt(element.getAttribute(\"line\"));\n      clef.m_clefLine = line;\n    } catch (e) {}\n    return clef;\n  }\n}\n\nexport class RestItem implements MusicItem {\n  readonly m_type = \"rest\";\n  m_line = -1;\n  m_id: string;\n  m_rhythm: number;\n  m_dot: boolean;\n\n  constructor (rhythm?: number) {\n    this.m_dot = false;\n    if (rhythm !== undefined) {\n      this.m_rhythm = rhythm;\n    } else {\n      this.m_rhythm = 1;\n    }\n  }\n\n  getHumdrumLine (options: object): string {\n    let output = \"\";\n    switch (this.m_rhythm) {\n      case 7: output += \"X\"; break;\n\t\t\tcase 9: output += \"L\"; break;\n\t\t\tcase 0: output += \"S\"; break;\n\t\t\tcase 1: output += \"s\"; break;\n\t\t\tcase 2: output += \"M\"; break;\n\t\t\tcase 4: output += \"m\"; break;\n\t\t\tcase 6: output += \"u\"; break;\n\t\t\tcase 8: output += \"U\"; break;\n    }\n    if (this.m_dot) {\n      output += \":\";\n    }\n    output += \"r\";\n    if (options[\"mark\"]) {\n      output += \"@\";\n    }\n    output += \"\\t.\";\n    return output;\n  }\n\n  static parseXML(element: Element): RestItem {\n    let rest = new RestItem();\n    if (element.hasAttribute(\"xml:id\")) {\n      rest.m_id = element.getAttribute(\"xml:id\");\n    }\n    if (element.hasAttribute(\"dur\")) {\n      rest.m_rhythm = parseRhythm(element.getAttribute(\"dur\"));\n    }\n    return rest;\n  }\n}\n\nexport class MensurItem implements MusicItem {\n  readonly m_type = \"mensur\";\n  m_line = -1;\n  m_modus: Mensuration;\n  m_tempus: Mensuration;\n  m_prolatio: Mensuration;\n  m_id: string;\n\n  constructor() {\n    this.m_modus = Mensuration.NA;\n    this.m_tempus = Mensuration.NA;\n    this.m_prolatio = Mensuration.NA;\n  }\n\n  getHumdrumLine(): string {\n    if (this.m_tempus === Mensuration.Two && this.m_prolatio === Mensuration.Two)\n      return \"*met(C)\\t*\";\n    if (this.m_tempus === Mensuration.Three && this.m_prolatio === Mensuration.Two)\n      return \"*met(O)\\t*\";\n    if (this.m_tempus === Mensuration.Two && this.m_prolatio === Mensuration.Three)\n      return \"*met(C.)\\t*\";\n    if (this.m_tempus === Mensuration.Three && this.m_prolatio === Mensuration.Three)\n      return \"*met(O.)\\t*\";\n    else\n      return \"*met(C)\\t*\";\n  }\n\n  static parseXML(element: Element): MensurItem {\n    let mensur = new MensurItem();\n    if (element.hasAttribute(\"xml:id\")) {\n      mensur.m_id = element.getAttribute(\"xml:id\");\n    }\n    if (element.hasAttribute(\"modusminor\")) {\n      mensur.m_modus = element.getAttribute(\"modus\") as Mensuration;\n    }\n    if (element.hasAttribute(\"tempus\")) {\n      mensur.m_tempus = element.getAttribute(\"tempus\") as Mensuration;\n    }\n    if (element.hasAttribute(\"prolatio\")) {\n      mensur.m_prolatio = element.getAttribute(\"prolatio\") as Mensuration;\n    }\n    return mensur;\n  }\n}\n\nexport class NoteItem implements MusicItem {\n  readonly m_type = \"note\";\n  m_line = -1;\n  m_pname: PitchClass;\n  m_accid: Accid;\n  m_oct: number;\n  m_rhythm: number;\n  m_dot: boolean;\n  m_text: string;\n  m_lig: LigStatus;\n  m_id: string;\n  m_plica: PlicaStatus;\n\n  constructor() {\n    this.m_pname = PitchClass.C;\n    this.m_accid = Accid.NONE;\n    this.m_oct = 4;\n    this.m_rhythm = 1;\n    this.m_dot = false;\n    this.m_text = \"\";\n    this.m_lig = LigStatus.NONE;\n    this.m_plica = PlicaStatus.NONE;\n  }\n\n  raisePitch (amount?: number) {\n    if (amount === undefined) {\n      amount = 1;\n    }\n    if (amount >= 7) {\n      this.m_oct += amount % 7;\n      amount -= 7 * (amount % 7);\n    }\n\n    this.m_pname += amount;\n    if (this.m_pname > 6) {\n      this.m_pname -= 7;\n      this.m_oct += 1;\n    }\n  }\n\n  lowerPitch (amount?: number) {\n    if (amount === undefined) {\n      amount = 1;\n    }\n    if (amount >= 7) {\n      this.m_oct -= amount % 7;\n      amount -= 7 * (amount % 7);\n    }\n    this.m_pname -= amount;\n    if (this.m_pname < 0) {\n      this.m_pname += 7;\n      this.m_oct -= 1;\n    }\n  }\n\n  getHumdrumLine(options: object): string {\n    let output = \"\";\n    if (this.m_lig === LigStatus.START) {\n      output += \"[\";\n    }\n    switch (this.m_rhythm) {\n      case 7: output += \"X\"; break;\n  \t\tcase 9: output += \"L\"; break;\n  \t\tcase 0: output += \"S\"; break;\n  \t\tcase 1: output += \"s\"; break;\n  \t\tcase 2: output += \"M\"; break;\n  \t\tcase 4: output += \"m\"; break;\n  \t\tcase 6: output += \"u\"; break;\n  \t\tcase 8: output += \"U\"; break;\n    }\n    if (this.m_dot) {\n      output += \":\";\n    }\n\n    let pname: string;\n    switch(this.m_pname) {\n      case PitchClass.C: pname = \"c\"; break;\n      case PitchClass.D: pname = \"d\"; break;\n      case PitchClass.E: pname = \"e\"; break;\n      case PitchClass.F: pname = \"f\"; break;\n      case PitchClass.G: pname = \"g\"; break;\n      case PitchClass.A: pname = \"a\"; break;\n      case PitchClass.B: pname = \"b\"; break;\n    }\n    if (this.m_oct >= 4) {\n      for (let i = 4; i <= this.m_oct; i++) {\n        output += pname;\n      }\n    } else {\n      pname = pname.toUpperCase();\n      for (let i = 3; i >= this.m_oct; i--) {\n        output += pname;\n      }\n    }\n\n    if (this.m_accid !== Accid.NONE) {\n      output += this.m_accid.toString();\n    }\n\n    if (this.m_lig === LigStatus.END) {\n      output += \"]\";\n    }\n\n    if (options[\"mark\"]) {\n      output += \"@\";\n    }\n    if (this.m_plica !== PlicaStatus.NONE) {\n      output += \"&\";\n    }\n\n    output += \"\\t\";\n    if (this.m_text) {\n      if (options[\"hyphen\"]) {\n        output += \"-\";\n      }\n      output += this.m_text;\n    } else {\n      output += \".\";\n    }\n\n    return output;\n  }\n\n  static parseXML(element: Element): NoteItem {\n    let note = new NoteItem();\n    // Set info from element attributes\n    if (element.hasAttribute(\"xml:id\")) {\n      note.m_id = element.getAttribute(\"xml:id\");\n    }\n    if (element.hasAttribute(\"oct\")) {\n      note.m_oct = parseInt(element.getAttribute(\"oct\"));\n    }\n    if (element.hasAttribute(\"dur\")) {\n      note.m_rhythm = parseRhythm(element.getAttribute(\"dur\"));\n    }\n    if (element.hasAttribute(\"pname\")) {\n      note.m_pname = PitchClass[element.getAttribute(\"pname\").toUpperCase()];\n    }\n    if (element.hasAttribute(\"plica\")) {\n      if (element.getAttribute(\"plica\") === \"up\") {\n        note.m_plica = PlicaStatus.UP;\n      }\n      else {\n        note.m_plica = PlicaStatus.DOWN;\n      }\n    }\n\n    // Check next sibling for dot\n    if (element.nextElementSibling && element.nextElementSibling.tagName === \"dot\") {\n      note.m_dot = true;\n    }\n\n    // Check children for accid, text\n    if (element.querySelector(\"accid\")) {\n      const accid = element.querySelector(\"accid\");\n      switch (accid.getAttribute(\"accid\")) {\n        case \"s\": note.m_accid = Accid.SHARP; break;\n        case \"f\": note.m_accid = Accid.FLAT; break;\n        case \"n\": note.m_accid = Accid.NATURAL; break;\n        default: break;\n      }\n    }\n    if (element.querySelector(\"syl\")) {\n      const syl = element.querySelector(\"syl\");\n      note.m_text = syl.textContent;\n    }\n\n    // Check parent for ligature\n    if (element.parentElement.tagName === \"ligature\") {\n      if (element === element.parentElement.firstElementChild) {\n        note.m_lig = LigStatus.START;\n      } else if (element === element.parentElement.lastElementChild) {\n        note.m_lig = LigStatus.END;\n      }\n    }\n\n    return note;\n  }\n}\n\nexport class MusicList {\n  m_list: Array<MusicItem> = [];\n  m_index = -1;\n  m_rhythm = 1;\n  m_notationCallback = null;\n\n  addClef (dpc: PitchClass) {\n    let item = new ClefItem();\n    if (dpc === PitchClass.G) {\n      item.m_pname = PitchClass.G;\n      item.m_clefLine = 2;\n    } else if (dpc === PitchClass.F) {\n      item.m_pname = PitchClass.F;\n      item.m_clefLine = 4;\n    } else {\n      item.m_pname = PitchClass.C;\n      item.m_clefLine = 3;\n    }\n    this.m_list.push(item);\n    this.runNotationCallback();\n  }\n\n  addRest () {\n    if (this.m_list.length === 0) return;\n    this.m_list.push(new RestItem(this.m_rhythm));\n    this.runNotationCallback();\n  }\n\n  addMensur () {\n    this.m_list.push(new MensurItem());\n    this.runNotationCallback();\n  }\n\n  addPitchFar (dpc: PitchClass) {\n    if (this.m_list.length === 0) {\n      this.addClef(dpc);\n      return;\n    }\n    dpc = (dpc + 7000) % 7;\n    let ln = this.getLastNote();\n    if (!ln) {\n      ln = new NoteItem();\n      ln.m_pname = PitchClass.C;\n      ln.m_oct = 4;\n      ln.m_rhythm = 1;\n    }\n    let oct = ln.m_oct;\n    let pitch = ln.m_pname + 7 * oct;\n    let candidate = [];\n    candidate[0] = (oct - 1) * 7 + dpc;\n    candidate[1] = (oct + 0) * 7 + dpc;\n    candidate[2] = (oct + 1) * 7 + dpc;\n    let best = -1;\n    for (let i = 0; i < candidate.length; i++) {\n      if ((Math.abs(pitch - candidate[i]) > 3) &&\n          (Math.abs(pitch - candidate[i]) < 8)) {\n        best = i;\n        break;\n      }\n    }\n    let newnote = new NoteItem();\n    newnote.m_rhythm = this.m_rhythm;\n    newnote.m_pname = dpc;\n    switch (best) {\n      case 0: newnote.m_oct = oct - 1; break;\n      case 1: newnote.m_oct = oct;     break;\n      case 2: newnote.m_oct = oct + 1; break;\n    }\n    this.m_list.push(newnote);\n    this.runNotationCallback();\n  }\n\n  addPitchNear (dpc: PitchClass) {\n    if (this.m_list.length == 0) {\n  \t\tthis.addClef(dpc);\n  \t\treturn;\n  \t}\n\n  \tdpc = (dpc + 7000) % 7;\n  \tlet ln = this.getLastNote();\n    if (!ln) {\n      ln = new NoteItem();\n      ln.m_pname = 0;\n      ln.m_oct = 4;\n      ln.m_rhythm = 1;\n    }\n    let oct = ln.m_oct;\n    let pitch = ln.m_pname + 7 * oct;\n    let candidate = [];\n    candidate[0] = (oct - 1) * 7 + dpc;\n  \tcandidate[1] = (oct + 0) * 7 + dpc;\n  \tcandidate[2] = (oct + 1) * 7 + dpc;\n    let best = -1;\n    for (let i = 0; i < candidate.length; i++) {\n      if (Math.abs(pitch - candidate[i]) < 4) {\n        best = i;\n        break;\n      }\n    }\n    let newnote = new NoteItem();\n    newnote.m_rhythm = this.m_rhythm;\n    newnote.m_pname = dpc;\n    switch (best) {\n      case 0: newnote.m_oct = oct - 1; break;\n      case 1: newnote.m_oct = oct;     break;\n      case 2: newnote.m_oct = oct + 1; break;\n    }\n    this.m_list.push(newnote);\n    this.runNotationCallback();\n  }\n\n  getLastNote(): NoteItem | null {\n    for (let i = this.m_list.length - 1; i >= 0; i--) {\n      if (this.m_list[i].m_type === \"note\") {\n        return this.m_list[i] as NoteItem;\n      }\n    }\n    return null;\n  }\n\n  removeLastItem() {\n    this.m_list.pop();\n    this.runNotationCallback();\n  }\n\n  hasOpenLigature(): boolean {\n    let open = false;\n    for (let item of this.m_list) {\n      if (item.m_type === \"note\") {\n        let note = item as NoteItem;\n        if (note.m_lig === LigStatus.START) {\n          open = true;\n        } else if (note.m_lig === LigStatus.END) {\n          open = false;\n        }\n      }\n    }\n    return open;\n  }\n\n  selectBackward() {\n    if (this.m_index > 0) {\n      this.m_index--;\n    } else if (this.m_index === 0) {\n      this.m_index = -1;\n    } else if (this.m_index < 0) {\n      this.m_index = this.m_list.length - 1;\n    }\n    this.runNotationCallback();\n  }\n\n  selectForward() {\n    if (this.m_index < this.m_list.length - 1) {\n  \t\tthis.m_index++;\n  \t} else if (this.m_index == this.m_list.length - 1) {\n  \t\tthis.m_index = -1;\n  \t} else if (this.m_index < 0) {\n  \t\tthis.m_index = 0;\n  \t}\n  \tthis.runNotationCallback();\n  }\n\n  runNotationCallback() {\n    if (this.m_notationCallback) {\n      let score = this.getHumdrumScore({});\n      this.m_notationCallback(score);\n    }\n  }\n\n  addTextToCurrentItem (text: string): boolean {\n    if (this.m_list.length === 0) {\n      return false;\n    }\n    let index = this.m_index;\n    if (index < 0) {\n      index = this.m_list.length - 1;\n    }\n    if (index < 0) {\n      return false;\n    }\n    let item = this.m_list[index];\n    if (item.m_type === \"note\") {\n      (item as NoteItem).m_text += text;\n      if (text === \"-\") {\n        this.m_index += 1;\n        if (this.m_index >= this.m_list.length) {\n          this.m_index = -1;\n        }\n      }\n    }\n    this.runNotationCallback();\n    return true;\n  }\n\n  goToEndOfList() {\n    this.m_index = -1;\n    this.runNotationCallback();\n  }\n\n  lowerPitch (amount: number) {\n    if (this.m_list.length === 0) return;\n    let index = this.m_index;\n    if (index < 0) index = this.m_list.length - 1;\n    if (this.m_list[index].m_type === \"note\") {\n      (this.m_list[index] as NoteItem).lowerPitch(amount);\n    }\n    else if (this.m_list[index].m_type === \"clef\") {\n      (this.m_list[index] as ClefItem).lowerPitch();\n    }\n    this.runNotationCallback();\n  }\n\n  raisePitch (amount: number) {\n    if (this.m_list.length === 0) return;\n    let index = this.m_index;\n    if (index < 0) index = this.m_list.length - 1;\n    if (this.m_list[index].m_type === \"note\") {\n      (this.m_list[index] as NoteItem).raisePitch(amount);\n    }\n    else if (this.m_list[index].m_type === \"clef\") {\n      (this.m_list[index] as ClefItem).raisePitch();\n    }\n    this.runNotationCallback();\n  }\n\n  deleteCharacterOnCurrentItem () {\n    let index = this.m_index;\n    if (index < 0) index = this.m_list.length - 1;\n    try {\n      let item = this.m_list[index] as NoteItem;\n      if (item.m_text.length === 0) return;\n      item.m_text = item.m_text.substring(0, item.m_text.length - 1);\n      this.runNotationCallback();\n    }\n    catch (e) {}\n  }\n\n  clearTextOnCurrentItem () {\n    let index = this.m_index;\n    if (index < 0 || index >= this.m_list.length) {\n      return;\n    }\n    let item = this.m_list[index];\n    if (!item) return;\n    try {\n      let note = item as NoteItem;\n      note.m_text = \"\";\n      this.runNotationCallback();\n    } catch (e) {}\n  }\n\n  clear () {\n    this.m_list = [];\n    this.m_index = -1;\n    this.runNotationCallback();\n  }\n\n  getHumdrumScore (opts?: object) {\n    if (!opts) {\n      opts = {};\n    }\n    let output = [];\n    output.push(\"**mens\\t**text\");\n    if (opts['white'] !== true) {\n  \t   output.push(\"*black\\t*\");\n    }\n  \tvar i: number;\n  \tvar lines: string;\n  \tvar noteCounter = 0;\n  \tvar restCounter = 0;\n  \tvar hyphen = false;\n  \tvar options = opts;\n  \tfor (i=0; i<this.m_list.length; i++) {\n  \t\tvar item = this.m_list[i];\n  \t\tif (item.m_type == \"note\") {\n  \t\t\tnoteCounter += 1;\n  \t\t} else if (item.m_type == \"rest\") {\n  \t\t\trestCounter += 1;\n  \t\t}\n  \t\toptions[\"mark\"] = false;\n  \t\toptions[\"hyphen\"] = hyphen;\n  \t\tif (i == this.m_index) {\n  \t\t\toptions[\"mark\"] = true;\n  \t\t}\n  \t\tif (options[\"export\"]) {\n  \t\t\toptions[\"mark\"] = false;\n  \t\t}\n      if (item.m_id === undefined) {\n        item.m_id = 'm-' + v4();\n      }\n  \t\tlines = item.getHumdrumLine(options);\n  \t\tif (item.m_type === \"note\") {\n  \t\t\tif ((item as NoteItem).m_text.match(/-$/)) {\n  \t\t\t\thyphen = true;\n  \t\t\t} else {\n  \t\t\t\thyphen = false;\n  \t\t\t}\n  \t  \t}\n  \t\tthis.m_list[i].m_line = output.length + 1;\n  \t\toutput.push(lines);\n  \t}\n  \tif (noteCounter + restCounter == 0) {\n  \t\t// need to add a dummy rest to force display of clef\n  \t\toutput.push(\"4ryy\\t.\");\n  \t}\n\n  \toutput.push(\"=-\\t=-\");\n  \toutput.push(\"*-\\t*-\");\n  \tif (!options[\"export\"]) {\n  \t\toutput.push(\"!!!RDF**kern: @ = marked note\");\n      output.push(\"!!!RDF**kern: & = marked note, color=green\")\n  \t\t//output.push(\"!!!RDF**kern: i = marked note, color=blue\");\n  \t\t//output.push(\"!!!RDF**mens: @ = marked note\");\n  \t}\n\n  \tvar output2 = \"\";\n  \tfor (i=0; i<output.length; i++) {\n  \t\toutput2 += output[i] + \"\\n\";\n  \t}\n  \treturn output2;\n  }\n\n  selectItemByLine (lineNumber: number) {\n    for (let i = 0; i < this.m_list.length; i++) {\n      if (this.m_list[i].m_line === lineNumber) {\n        this.m_index = i;\n        this.runNotationCallback();\n        return;\n      }\n    }\n  }\n\n  processKeySig (pitch: string, accid: string): boolean {\n    if (this.m_list.length > 0) {\n      let first = this.m_list[0] as ClefItem;\n      if (first.m_type !== \"clef\") {\n        console.debug(\"First was not a clef!!!\");\n        return false;\n      }\n      if (first.m_keySig.has(pitch)) {\n        if (first.m_keySig.get(pitch) === accid) {\n          first.m_keySig.delete(pitch);\n        } else {\n          first.m_keySig.set(pitch, accid);\n        }\n      }\n      else {\n        first.m_keySig.set(pitch, accid);\n      }\n      this.runNotationCallback();\n      return true;\n    }\n  }\n}\n","import { v4 as uuidv4 } from 'uuid';\n\nimport { MusicList } from './MusicItem';\n\n// The voice a staff belongs to\nexport enum Voice {\n  altus='altus',\n  cantus='cantus',\n  contratenor='contratenor',\n  contratenor1='contratenor I',\n  contratenor2='contratenor II',\n  discantus='discantus',\n  duplum='duplum',\n  lowervoice1='lower voice I',\n  lowervoice2='lower voice II',\n  motetus='motetus',\n  quadruplum='quadruplum',\n  quintus='quintus',\n  superius='superius',\n  uppervoice1='upper voice I',\n  uppervoice2='uppervoice II',\n  tenor='tenor',\n  triplum='triplum',\n  bassus='bassus'\n}\n\n// Values for modus, tempus, and prolatio\nexport enum Mensuration {\n  Three='3',\n  Two='2',\n  NA='N/A'\n}\n\nexport type BoundingBox = {\n  ulx: number;\n  uly: number;\n  lrx: number;\n  lry: number;\n}\n\nexport type PartMensuration = {\n  modus: Mensuration,\n  tempus: Mensuration,\n  prolatio: Mensuration\n};\n\nexport type VoicePair = {\n  voice: Voice,\n  mensurations: PartMensuration\n};\n\n/** Typedef to show when something is a IIIF manifest IRI */\nexport type IRI = string;\n\n/**\n * Class representing a staff that is selected on a canvas.\n * Should contain all the information about a staff that is available.\n */\nexport class Staff {\n  constructor(\n    ulx: number,\n    uly: number,\n    lrx: number,\n    lry: number,\n    canvas: string,\n    index: number,\n    voice?: Voice,\n    id?: string,\n    musicList?: MusicList\n  ) {\n    if (id) {\n      this.id = id;\n    }\n    else {\n      this.id = uuidv4();\n    }\n    this.bbox = { ulx: ulx, uly: uly, lrx: lrx, lry: lry };\n    this.canvas = canvas;\n    this.index = index;\n    if (voice) {\n      this.voice = voice;\n    }\n    else {\n      this.voice = Voice.triplum;\n    }\n\n    if (musicList) {\n      this.musicList = musicList;\n    }\n    else {\n      this.musicList = new MusicList();\n    }\n  }\n\n  get svg() {\n    let rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n    rect.setAttribute('x', this.bbox.ulx.toString());\n    rect.setAttribute('y', this.bbox.uly.toString());\n    rect.id = this.id;\n    rect.setAttribute('width', (this.bbox.lrx - this.bbox.ulx).toString());\n    rect.setAttribute('height', (this.bbox.lry - this.bbox.uly).toString());\n    rect.classList.add(\"zoneRect\");\n    return rect;\n  }\n\n  static compare(staffA: Staff, staffB: Staff): number {\n    let indexDiff = staffA.index - staffB.index;\n    if (indexDiff !== 0) {\n      return indexDiff;\n    }\n    else {\n      return staffA.bbox.uly - staffB.bbox.uly;\n    }\n  }\n\n  id: string;\n\n  // Information about the contents of the staff\n  voice: Voice;\n  modus: Mensuration;\n  tempus: Mensuration;\n  prolatio: Mensuration;\n\n  bbox: BoundingBox;  // Relative to the canvas\n  canvas: string;     // IIIF canvas @id for the page containing this staff.\n  index: number;      // 0-based page index\n\n  musicList: MusicList;\n}\n","import { Part, Tenor } from './part';\nimport { System, Pb, Sb } from './system';\nimport { ClefItem, NoteItem, RestItem, MensurItem } from './MusicItem';\nimport { Voice, Mensuration } from './definitions';\nimport { IRI } from './definitions';\n\n\nexport const NAMESPACE = 'http://www.music-encoding.org/ns/mei';\n\nexport class MEIDocument {\n  parts: Part[];\n  metadata: Metadata;  // Should this be broken up better?\n  notationSubtype: string;\n\n  _meiDoc: Document;\n\n  get notationType(): string {\n    if (/Ars[_ ](antiqua|nova)/.test(this.notationSubtype)) {\n      return \"mensural.black\";\n    } else {\n      return \"mensural.white\";\n    }\n  }\n\n  constructor (manuscriptIRI: IRI) {  // This is for creating a new document\n    this.metadata = new Metadata();\n    this.metadata.sourceIRI = manuscriptIRI;\n    this.parts = [];\n    this._createSkeletonMEI();\n  }\n\n  static fromXML(source: XMLDocument): MEIDocument {\n    let doc = source.documentElement;\n    let iiif = \"\";\n    try {\n      let sourceElement = doc.querySelector(\"source\");\n      iiif = sourceElement.getAttribute(\"target\");\n    } catch (e) {\n      console.debug(e);\n    }\n    let mei = new MEIDocument(iiif);\n\n    // Try to get metadata\n    let titleStmt = doc.querySelector(\"titleStmt\");\n    if (titleStmt) {\n      if (titleStmt.querySelector(\"title\")) {\n        mei.metadata.shortTitle = titleStmt.querySelector(\"title\").textContent;\n      }\n      if (titleStmt.querySelector(\"persName\") && titleStmt.querySelector(\"persName\").getAttribute(\"role\") === \"encoder\") {\n        mei.metadata.encoderName = titleStmt.querySelector(\"persName\").textContent;\n      }\n      if (titleStmt.querySelector(\"composer\")) {\n        mei.metadata.composerName = titleStmt.querySelector(\"composer\").textContent;\n      }\n    }\n\n    let facsimile = doc.querySelector(\"facsimile\");\n    let surfaces = Array.from(facsimile.querySelectorAll(\"surface\"));\n    let zones = Array.from(facsimile.querySelectorAll(\"zone\"));\n\n    // Start processing parts\n    const parts = Array.from(doc.querySelectorAll(\"part\"));\n    for (const part of parts) {\n      let staffDef = part.querySelector(\"staffDef\");\n      console.assert(staffDef.hasAttribute(\"label\"));\n      let voice = staffDef.getAttribute(\"label\");\n      let partObj: Part | Tenor = /^[tT]enor/.test(voice) ? new Tenor(mei, part.getAttribute(\"xml:id\")) : new Part(mei, part.getAttribute(\"xml:id\"));\n      partObj.voice = Voice[voice];\n      mei.parts.push(partObj);\n      let mensur = staffDef.querySelector(\"mensur\");\n\n      if (staffDef.hasAttribute(\"notationsubtype\")) {\n        mei.notationSubtype = staffDef.getAttribute(\"notationsubtype\");\n      } else {\n        mei.notationSubtype = \"\";\n      }\n      if (staffDef.hasAttribute(\"modusminor\")) {\n        partObj.modus = staffDef.getAttribute(\"modusminor\") as Mensuration;\n      } else if (mensur && mensur.hasAttribute(\"modusminor\")) {\n        partObj.modus = mensur.getAttribute(\"modusminor\") as Mensuration;\n      }\n      if (staffDef.hasAttribute(\"tempus\")) {\n        partObj.tempus = staffDef.getAttribute(\"tempus\") as Mensuration;\n      } else if (mensur && mensur.hasAttribute(\"tempus\")) {\n        partObj.tempus = mensur.getAttribute(\"tempus\") as Mensuration;\n      }\n      if (staffDef.hasAttribute(\"prolatio\")) {\n        partObj.prolatio = staffDef.getAttribute(\"prolatio\") as Mensuration;\n      } else if (mensur && mensur.hasAttribute(\"prolatio\")) {\n        partObj.prolatio = mensur.getAttribute(\"prolatio\") as Mensuration;\n      }\n\n      const layer = part.querySelector(\"layer\");\n      // Handle repeating tenor if tenor\n      if (/^[tT]enor/.test(partObj.voice)) {\n        const dir = part.querySelector(\"dir\");\n        if (dir) {\n          const tenorObj = partObj as Tenor;\n          tenorObj.repetitions = Number(dir.getAttribute(\"n\")) + 1\n          const matchResults = dir.getAttribute(\"plist\").match(/^#[-\\w\\d]+ #([-\\w\\d]+)$/);\n          if (matchResults.length > 1) {\n            tenorObj.endingId = matchResults[1];\n          }\n        }\n      }\n      // Handle regular children\n      const layerChildren = Array.from(layer.querySelectorAll(\"pb,sb,clef,note,rest,mensur\"));\n      let activePb: Pb = null;\n      let activeSystem: System = null;\n      for (const child of layerChildren) {\n        if (child.tagName === \"pb\") {\n          let facs = child.getAttribute(\"facs\").split(\"#\")[1];\n          console.assert(surfaces.some(el => { return el.getAttribute(\"xml:id\") === facs; }));\n          let surface = surfaces.find(el => { return el.getAttribute(\"xml:id\") === facs; });\n          let graphic = surface.querySelector(\"graphic\");\n          activePb = new Pb(graphic.getAttribute(\"target\"), child.getAttribute(\"xml:id\"));\n\n          // Determine Pb index\n          function setIndex(pb: Pb) {\n            fetch(iiif).then(response => {\n              return response.json();\n            }).then((manifest: object) => {\n              let canvases: object[] = manifest[\"sequences\"][0][\"canvases\"];\n              pb.index = canvases.findIndex(canvas => { return canvas[\"@id\"] === pb.canvasIRI; });\n            });\n          }\n\n          setIndex(activePb);\n        } else if (child.tagName === \"sb\") {\n          let sb: Sb;\n          if (child.hasAttribute(\"facs\")) {\n            let facs = child.getAttribute(\"facs\").split(\"#\")[1];\n            console.assert(zones.some(el => { return el.getAttribute(\"xml:id\") === facs; }));\n            let zone = zones.find(el => { return el.getAttribute(\"xml:id\") === facs; });\n            sb = new Sb(\n              {\n                ulx: Number(zone.getAttribute(\"ulx\")),\n                uly: Number(zone.getAttribute(\"uly\")),\n                lrx: Number(zone.getAttribute(\"lrx\")),\n                lry: Number(zone.getAttribute(\"lry\"))\n              },\n              child.getAttribute(\"xml:id\")\n            );\n          } else {\n            sb = new Sb({ulx: 0, uly: 0, lrx: 0, lry: 0}, child.getAttribute(\"xml:id\"));\n          }\n          activeSystem = new System();\n          activeSystem.sb = sb;\n          activeSystem.pb = activePb;\n          partObj.addSystem(activeSystem);\n        } else if (child.tagName === \"clef\") {\n          let clef = ClefItem.parseXML(child);\n          activeSystem.contents.m_list.push(clef);\n        } else if (child.tagName === \"rest\") {\n          let rest = RestItem.parseXML(child);\n          activeSystem.contents.m_list.push(rest);\n        } else if (child.tagName === \"note\") {\n          let note = NoteItem.parseXML(child);\n          activeSystem.contents.m_list.push(note);\n        } else if (child.tagName === \"mensur\") {\n          let mensur = MensurItem.parseXML(child);\n          activeSystem.contents.m_list.push(mensur);\n        }\n      }\n    }\n\n    return mei;\n  }\n\n  generateXML(): Document {\n    this._createSkeletonMEI();\n    let parts = this._meiDoc.querySelector('parts');\n    for (let part of this.parts) {\n      if (part.systems.length === 0) {\n        continue;\n      }\n      let partElement = /^[tT]enor/.test(part.voice) ?\n        (part as Tenor).generatePartXML() : part.generatePartXML();\n      if (partElement.querySelector('layer').children.length === 0) continue;\n      parts.appendChild(partElement);\n    }\n    return this._meiDoc;\n  }\n\n  _createSkeletonMEI() {\n    this._meiDoc = document.implementation.createDocument(NAMESPACE, 'mei', null);\n    let mei = this._meiDoc.documentElement;\n    mei.setAttribute('meiversion', '4.0.1');\n    // Create Header\n    let head = this._generateHeader();\n    // TODO Add more to header\n    mei.appendChild(head);\n\n    // Create music skeleton\n    let music = this._meiDoc.createElementNS(NAMESPACE, 'music');\n    let facsimile = this._meiDoc.createElementNS(NAMESPACE, 'facsimile');\n    let body = this._meiDoc.createElementNS(NAMESPACE, 'body');\n    let mdiv = this._meiDoc.createElementNS(NAMESPACE, 'mdiv');\n    let parts = this._meiDoc.createElementNS(NAMESPACE, 'parts');\n    mei.appendChild(music);\n    music.appendChild(facsimile);\n    music.appendChild(body);\n    body.appendChild(mdiv);\n    mdiv.appendChild(parts);\n  }\n\n  _generateHeader(): Element {\n    let meiHead = this._meiDoc.createElementNS(NAMESPACE, \"meiHead\");\n    let fileDesc = this._meiDoc.createElementNS(NAMESPACE, \"fileDesc\");\n    meiHead.appendChild(fileDesc);\n    let titleStmt = this._meiDoc.createElementNS(NAMESPACE, \"titleStmt\");\n    fileDesc.appendChild(titleStmt);\n    let title = this._meiDoc.createElementNS(NAMESPACE, \"title\");\n    title.textContent = this.metadata.shortTitle;\n    titleStmt.appendChild(title);\n    let composer = this._meiDoc.createElementNS(NAMESPACE, \"composer\");\n    composer.textContent = this.metadata.composerName;\n    titleStmt.appendChild(composer);\n    let respStmt = this._meiDoc.createElementNS(NAMESPACE, \"respStmt\");\n    titleStmt.appendChild(respStmt);\n    let persName = this._meiDoc.createElementNS(NAMESPACE, \"persName\");\n    persName.textContent = this.metadata.encoderName;\n    persName.setAttribute(\"role\", \"encoder\");\n    respStmt.appendChild(persName);\n    let pubStmt = this._meiDoc.createElementNS(NAMESPACE, \"pubStmt\");\n    fileDesc.appendChild(pubStmt);\n\n    let sourceDesc = this._meiDoc.createElementNS(NAMESPACE, \"sourceDesc\");\n    fileDesc.appendChild(sourceDesc);\n    let source = this._meiDoc.createElementNS(NAMESPACE, \"source\");\n    source.setAttribute(\"target\", this.metadata.sourceIRI);\n    sourceDesc.appendChild(source);\n\n    return meiHead;\n  }\n\n  getSystems(): System[] {\n    let allSystems: System[] = [];\n    for (let part of this.parts) {\n      allSystems.unshift(...part.systems);\n    }\n    return allSystems;\n  }\n\n  getSystem(id: string): System {\n    let allSystems = this.getSystems();\n    let systemList = allSystems.filter(system => { return system.id === id; });\n    return systemList.length > 0 ? systemList[0] : null;\n  }\n\n  getPart(voice: Voice): Part {\n    let partlist = this.parts.filter(part => { return part.voice === voice; });\n    return partlist.length > 0 ? partlist[0] : null;\n  }\n\n  getOrCreatePart(voice: Voice): Part {\n    if (this.parts.some(part => { return part.voice === voice; })) {\n      return this.getPart(voice);\n    }\n    let part = /^[tT]enor/.test(voice) ? new Tenor(this) : new Part(this);\n    part.voice = voice;\n    this.parts.push(part);\n    return part;\n  }\n\n  getPb(index: number): Pb {\n    let pbs = new Set<Pb>();\n    for (let part of this.parts) {\n      part.systems.forEach(system => {\n        pbs.add(system.pb);\n      });\n    }\n    for (let pb of pbs.values()) {\n      if (pb.index === index) return pb;\n    }\n    return null;\n  }\n}\n\nclass Metadata {\n  shortTitle: string;\n  sourceIRI: IRI;\n  composerName: string;\n  encoderName: string;\n}\n","import { v4 as uuid } from 'uuid';\n\nimport { Voice, Mensuration, IRI } from './definitions';\nimport { System } from './system';\nimport { MEIDocument, NAMESPACE } from './mei';\n\nexport class Part {\n  voice: Voice;\n  modus: Mensuration;\n  tempus: Mensuration;\n  prolatio: Mensuration;\n  id: string;\n  parent: MEIDocument;\n\n  systems: System[];\n\n  constructor(doc: MEIDocument, id?: string) {\n    this.parent = doc;\n    if (id) {\n      this.id = id;\n    } else {\n      id = 'm-' + uuid();\n    }\n\n    this.systems = [];\n    this.modus = Mensuration.NA;\n    this.tempus = Mensuration.NA;\n    this.prolatio = Mensuration.NA;\n  }\n\n  addSystem(system: System) {\n    system.parent = this;\n    this.systems.push(system);\n  }\n\n  removeSystem(id: string): System {\n    let matches = this.systems.filter(system => { return system.id === id; });\n    if (matches.length > 0) {\n      let index = this.systems.indexOf(matches[0]);\n      let removed = this.systems.splice(index, 1);\n      return removed[0];\n    }\n    return null;\n  }\n\n  generatePartXML(): Element {\n    this.systems.sort(System.compare);\n    let part = this.parent._meiDoc.createElementNS(NAMESPACE, 'part');\n    let scoreDef = this._generateScoreDef();\n    part.appendChild(scoreDef);\n\n    let staffDef = scoreDef.querySelector('staffDef');\n    staffDef.setAttribute('label', this.voice.toString());\n    let mensur = this.parent._meiDoc.createElementNS(NAMESPACE, 'mensur');\n    staffDef.appendChild(mensur);\n    if (this.modus !== Mensuration.NA) {\n      mensur.setAttribute('modusminor', this.modus.toString());\n    }\n    if (this.tempus !== Mensuration.NA) {\n      mensur.setAttribute('tempus', this.tempus.toString());\n    }\n    if (this.prolatio !== Mensuration.NA) {\n      mensur.setAttribute('prolatio', this.prolatio.toString());\n    }\n\n    let section = this.parent._meiDoc.createElementNS(NAMESPACE, 'section');\n    part.appendChild(section);\n    let staff = this.parent._meiDoc.createElementNS(NAMESPACE, 'staff');\n    staff.setAttribute('n', '1');\n    section.appendChild(staff);\n    let layer = this.parent._meiDoc.createElementNS(NAMESPACE, 'layer');\n    layer.setAttribute('n', '1');\n    staff.appendChild(layer);\n\n    let currentPage: IRI = null\n    let graphic: Element = null;\n    let facsimile: Element = this.parent._meiDoc.querySelector('facsimile');\n    for (let system of this.systems) {\n      let contents = system.getContents();\n      console.debug(contents);\n      if (contents.filter(el => { return el.tagName === 'note'; }).length === 0) {\n        continue;\n      }\n      // Handle paging\n      if (system.pb.canvasIRI !== currentPage) {\n        let pb = this.parent._meiDoc.createElementNS(NAMESPACE, 'pb');\n        let temp = Array.from(facsimile.querySelectorAll('graphic'))\n          .filter(graphic => graphic.getAttribute('target') === system.pb.canvasIRI);\n        if (temp.length > 0) {\n          // Use existing page in mei\n          graphic = temp[0];\n        } else {\n          // Create new page\n          let surface = this.parent._meiDoc.createElementNS(NAMESPACE, 'surface');\n          surface.setAttribute('xml:id', 'm-' + uuid());\n          graphic = this.parent._meiDoc.createElementNS(NAMESPACE, 'graphic');\n          graphic.setAttribute('xml:id', 'm-' + uuid());\n          graphic.setAttribute('target', system.pb.canvasIRI);\n          surface.appendChild(graphic);\n          facsimile.appendChild(surface);\n        }\n        let surface = graphic.closest(\"surface\");\n        pb.setAttribute('facs', '#' + surface.getAttribute('xml:id'));\n        pb.setAttribute('xml:id', system.pb.id);\n        currentPage = system.pb.canvasIRI;\n        layer.appendChild(pb);\n      }\n\n      // Handle sb\n      let zone = this.parent._meiDoc.createElementNS(NAMESPACE, 'zone');\n      let zoneId = 'm' + uuid();\n      zone.setAttribute('xml:id', zoneId);\n      zone.setAttribute('ulx', Math.round(system.sb.zone.ulx).toString());\n      zone.setAttribute('uly', Math.round(system.sb.zone.uly).toString());\n      zone.setAttribute('lrx', Math.round(system.sb.zone.lrx).toString());\n      zone.setAttribute('lry', Math.round(system.sb.zone.lry).toString());\n      graphic.appendChild(zone);\n\n      let sb = this.parent._meiDoc.createElementNS(NAMESPACE, 'sb');\n      sb.setAttribute('facs', '#' + zone.getAttribute('xml:id'));\n      sb.setAttribute('xml:id', system.sb.id);\n      layer.appendChild(sb);\n\n      // Add contents. Child here should have correct xml:id including children\n      contents.forEach(child => {\n        // Remove @color and @marked\n        if (child.hasAttribute('color')) child.removeAttribute('color');\n        if (child.hasAttribute('type')) child.removeAttribute('type');\n\n        if (child.tagName === 'ligature') {\n          child.removeAttribute('form');\n        }\n\n        layer.appendChild(child);\n      });\n    }\n    return part;\n  }\n\n  _generateScoreDef(): Element {\n    let scoreDef = this.parent._meiDoc.createElementNS(NAMESPACE, 'scoreDef');\n    let staffGrp = this.parent._meiDoc.createElementNS(NAMESPACE, 'staffGrp');\n    scoreDef.appendChild(staffGrp);\n    let staffDef = this.parent._meiDoc.createElementNS(NAMESPACE, 'staffDef');\n    staffDef.setAttribute('n', '1');\n    staffDef.setAttribute('lines', '5');\n    staffDef.setAttribute('notationtype', this.parent.notationType);\n    staffDef.setAttribute('notationsubtype', this.parent.notationSubtype);\n    staffGrp.appendChild(staffDef);\n    return scoreDef;\n  }\n}\n\nexport class Tenor extends Part {\n  repetitions: number;\n  endingId: string;\n\n  constructor(doc: MEIDocument, id?: string) {\n    super(doc, id);\n    this.voice = Voice.tenor;\n    this.repetitions = 1;   // default\n  }\n\n  generatePartXML(): Element {\n    let part = super.generatePartXML();\n    // Set repeating tenor if necessary\n    if (this.repetitions > 1) {\n      /* IMPORTANT NOTE */\n      /* The \"n\" attribute here is used to represent the number of repetitions */\n      /* It does NOT mean this is the nth directive of the piece */\n      /* This should be replaced with a correct MEI attribute when possible */\n      let dir = this.parent._meiDoc.createElementNS(NAMESPACE, 'dir');\n      dir.setAttribute('n', (this.repetitions - 1).toString());\n      dir.setAttribute('layer', '1');\n      let firstNoteId = part.querySelector('note').getAttribute('xml:id');\n      let endingId = (this.endingId !== undefined) ? this.endingId : part.querySelector('layer').lastElementChild.getAttribute('xml:id');\n      dir.setAttribute('plist', '#' + firstNoteId + ' #' + endingId);\n      dir.setAttribute('follows', '#' + endingId);\n      let staff = part.querySelector('staff');\n      staff.appendChild(dir);\n      dir.insertAdjacentHTML(\n        'beforebegin',\n        '<!-- The @n attribute on <dir> is used to represent the number of repetitions in a machine readable format. -->'\n      );\n    }\n    return part;\n  }\n}\n","import { IRI, BoundingBox, Voice, Mensuration } from './definitions';\nimport { MusicList, NoteItem, MensurItem, PlicaStatus } from './MusicItem';\nimport { Part } from './part';\nimport { v4 as uuid } from 'uuid';\nimport { vrvToolkit } from './verovio';\n\nexport class Pb {\n  canvasIRI: IRI;\n  index: number;\n  id: string;\n\n  constructor(iri: IRI, id?: string) {\n    this.canvasIRI = iri;\n    if (id) {\n      this.id = id;\n    } else {\n      this.id = 'm-' + uuid();\n    }\n  }\n}\n\nexport class Sb {\n  zone: BoundingBox;\n  id: string;\n\n  constructor(zone: BoundingBox, id?: string) {\n    if (id) {\n      this.id = id;\n    } else {\n      this.id = 'm-' + uuid();\n    }\n\n    this.zone = zone;\n  }\n\n  get svg() {\n    let rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n    rect.setAttribute('x', this.zone.ulx.toString());\n    rect.setAttribute('y', this.zone.uly.toString());\n    rect.id = this.id;\n    rect.setAttribute('width', (this.zone.lrx - this.zone.ulx).toString());\n    rect.setAttribute('height', (this.zone.lry - this.zone.uly).toString());\n    rect.classList.add('zoneRect');\n    return rect;\n  }\n}\n\nexport class System {\n  pb: Pb;\n  sb: Sb;\n  parent: Part;\n  contents: MusicList;\n\n  constructor (contents?: MusicList) {\n    if (contents) {\n      this.contents = contents;\n    } else {\n      this.contents = new MusicList();\n    }\n  }\n\n  static compare(a: System, b: System): number {\n    let diff = a.pb.index - b.pb.index;\n    if (diff !== 0) return diff;\n    // Check for intersection on y-axis. If so, left-most. Else highest.\n    const aZone = a.sb.zone;\n    const bZone = b.sb.zone;\n    if ((aZone.lry <= bZone.lry && aZone.lry >= bZone.uly) || (aZone.uly <= bZone.lry && aZone.uly >= bZone.uly) ||\n      (bZone.lry <= aZone.lry && bZone.lry >= aZone.uly) || (bZone.uly <= aZone.lry && bZone.lry >= aZone.uly)) {\n      return aZone.ulx - bZone.ulx;\n    } else {\n      return a.sb.zone.uly - b.sb.zone.uly;\n    }\n  }\n\n  get id(): string {\n    return this.sb.id;\n  }\n\n  get voice(): Voice {\n    return this.parent.voice;\n  }\n\n  set voice(voice: Voice) {\n    if (voice !== this.parent.voice) {\n      let newPart = this.parent.parent.getOrCreatePart(voice);\n      let idx = this.parent.systems.indexOf(this);\n      this.parent.systems.splice(idx, 1);\n      newPart.addSystem(this);\n    }\n  }\n\n  getContents(): Element[] {\n    let whiteMensural = this.parent.parent.notationType === \"mensural.white\";\n    console.debug(this.parent.parent.notationType);\n    let rawMei = vrvToolkit.humdrumToMEI(this.contents.getHumdrumScore({white: whiteMensural}));\n    let parser = new DOMParser();\n    let elements: Element[] = [];\n    let humdrumMei = parser.parseFromString(rawMei, 'application/xml');\n    let clef = humdrumMei.querySelector('clef');\n    if (clef !== null) {\n      this._recurseId(clef);\n      elements.push(clef);\n    }\n    let mensur = humdrumMei.querySelector('mensur');\n    if (mensur !== null && mensur.closest('layer') === null) {\n      this._recurseId(mensur);\n      elements.push(mensur);\n    }\n    let layer = humdrumMei.querySelector('layer');\n    console.debug(layer);\n    if (layer !== null) {\n      for (let child of Array.from(layer.children)) {\n        this._recurseId(child);\n        if (child.tagName === \"note\" && child.hasAttribute(\"dots\")) {\n          child.removeAttribute(\"dots\");\n        }\n        elements.push(child);\n      }\n    }\n    return elements;\n  }\n\n  _recurseId(element: Element) {\n    let id = element.getAttribute('xml:id');\n    let found = false;\n    if (id && /(note|rest|clef|pb|sb|mensur)/.test(element.tagName)) {\n      let regexpInfo = id.match(/L(\\d+)[\\w\\d]+$/);\n      if (regexpInfo) {\n        let line = parseInt(regexpInfo[1]);\n        let match = this.contents.m_list.filter(el => {\n          return el.m_line === line;\n        });\n        if (match.length > 0) {\n          found = true;\n          element.setAttribute('xml:id', match[0].m_id);\n          if (match[0].m_type === \"mensur\") {\n            let mensur = match[0] as MensurItem;\n            if (mensur.m_modus !== Mensuration.NA) {\n              element.setAttribute(\"modusminor\", mensur.m_modus.toString());\n            }\n            if (mensur.m_tempus !== Mensuration.NA) {\n              element.setAttribute(\"tempus\", mensur.m_tempus.toString());\n            }\n            if (mensur.m_prolatio !== Mensuration.NA) {\n              element.setAttribute(\"prolatio\", mensur.m_prolatio.toString());\n            }\n            if (element.hasAttribute('sign')) {\n              element.removeAttribute('sign');\n            }\n            if (element.hasAttribute('dot')) {\n              element.removeAttribute('dot');\n            }\n          }\n          else if (match[0].m_type === 'note') {\n            let note = match[0] as NoteItem;\n            if (note.m_plica === PlicaStatus.UP) {\n              element.setAttribute('plica', 'up');\n            }\n            else if (note.m_plica === PlicaStatus.DOWN) {\n              element.setAttribute('plica', 'down');\n            }\n          }\n        }\n      }\n    }\n    if (!found) {\n      element.setAttribute('xml:id', 'm-' + uuid());\n    }\n    for (let child of Array.from(element.children)) {\n      this._recurseId(child);\n    }\n  }\n}\n","declare let verovio;\ndeclare let verovioReady: boolean;\n\nclass VrvObj {\n  vrvToolkit = null;\n  options = null;\n\n  constructor() {\n    this.options = {\n      humType: 0,\n      scale: 90,\n      spacingNonLinear: 0.35,\n      lyricSize: 3,\n      breaks: 'none',\n    }\n  }\n\n  setup() {\n    if (!this.vrvToolkit) {\n      this.vrvToolkit = new verovio.toolkit();\n      this.vrvToolkit.setOptions(this.options);\n    }\n  }\n\n  humdrumToMEI(data: string): string {\n    this.vrvToolkit.loadData(data);\n    return this.vrvToolkit.getMEI({\n      pageNo: 0,\n      scoreBased: true\n    });\n  }\n\n  humdrumToSVG(humdrumData: string): SVGSVGElement {\n    this.vrvToolkit.loadData(humdrumData);\n    let data = this.vrvToolkit.renderToSVG(1);\n    const parser = new DOMParser();\n    return parser.parseFromString(data, 'image/svg+xml').documentElement as unknown as SVGSVGElement;\n  }\n\n  meiToSVG(meiDoc: XMLDocument): SVGSVGElement {\n    const serializer = new XMLSerializer();\n    const serializedMei = serializer.serializeToString(meiDoc);\n    const parser = new DOMParser();\n    this.vrvToolkit.loadData(serializedMei);\n    const svgRaw = this.vrvToolkit.renderToSVG(1);\n    return parser.parseFromString(svgRaw, 'image/svg+xml').documentElement as unknown as SVGSVGElement;\n  }\n}\n\nexport const vrvToolkit = new VrvObj();\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\ndeclare let verovioReady: boolean;\n\nif (environment.production) {\n  enableProdMode();\n}\n\ninit().then( () => {\n  platformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err))\n});\n\nasync function init() {\n  console.debug('check');\n  while (!verovioReady) {\n    console.debug('wait');\n    await new Promise(r => { setTimeout(r, 250); });\n  }\n  console.debug('done');\n}\n"],"sourceRoot":"webpack:///"}